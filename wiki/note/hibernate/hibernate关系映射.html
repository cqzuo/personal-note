<?xml version="1.0" encoding="gbk"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
lang="en" xml:lang="en">
<head>
<title>hibernate关系映射</title>
<meta http-equiv="Content-Type" content="text/html;charset=gbk"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2011-02-10 16:52:05 "/>
<meta name="author" content=""/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style><link rel="stylesheet" type="text/css" href="org.css">
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">

<h1 class="title">hibernate关系映射</h1>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 单向关联 </a>
<ul>
<li><a href="#sec-1_1">1.1 一对一 </a>
<ul>
<li><a href="#sec-1_1_1">1.1.1 外键 </a></li>
<li><a href="#sec-1_1_2">1.1.2 主键 </a></li>
<li><a href="#sec-1_1_3">1.1.3 连接表 </a></li>
</ul>
</li>
<li><a href="#sec-1_2">1.2 一对多 </a>
<ul>
<li><a href="#sec-1_2_1">1.2.1 外键 </a></li>
<li><a href="#sec-1_2_2">1.2.2 连接表 </a></li>
</ul>
</li>
<li><a href="#sec-1_3">1.3 多对一 </a>
<ul>
<li><a href="#sec-1_3_1">1.3.1 外键 </a></li>
<li><a href="#sec-1_3_2">1.3.2 连接表 </a></li>
</ul>
</li>
<li><a href="#sec-1_4">1.4 多对多 </a></li>
</ul>
</li>
<li><a href="#sec-2">2 双向关联 </a>
<ul>
<li><a href="#sec-2_1">2.1 一对一 </a>
<ul>
<li><a href="#sec-2_1_1">2.1.1 外键 </a></li>
<li><a href="#sec-2_1_2">2.1.2 主键 </a></li>
<li><a href="#sec-2_1_3">2.1.3 连接表 </a></li>
</ul>
</li>
<li><a href="#sec-2_2">2.2 一对多 </a>
<ul>
<li><a href="#sec-2_2_1">2.2.1 外键 </a></li>
<li><a href="#sec-2_2_2">2.2.2 连接表 </a></li>
</ul>
</li>
<li><a href="#sec-2_3">2.3 多对多 </a>
<ul>
<li><a href="#sec-2_3_1">2.3.1 模型 </a></li>
<li><a href="#sec-2_3_2">2.3.2 实体 </a></li>
<li><a href="#sec-2_3_3">2.3.3 表模型 </a></li>
<li><a href="#sec-2_3_4">2.3.4 SQL脚本 </a></li>
<li><a href="#sec-2_3_5">2.3.5 映射方法 </a></li>
<li><a href="#sec-2_3_6">2.3.6 测试方法 </a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> 单向关联 </h2>
<div class="outline-text-2" id="text-1">


</div>

<div id="outline-container-1_1" class="outline-3">
<h3 id="sec-1_1"><span class="section-number-3">1.1</span> 一对一 </h3>
<div class="outline-text-3" id="text-1_1">


</div>

<div id="outline-container-1_1_1" class="outline-4">
<h4 id="sec-1_1_1"><span class="section-number-4">1.1.1</span> 外键 </h4>
<div class="outline-text-4" id="text-1_1_1">

<ul>
<li id="sec-1_1_1_1">模型 <br/>
<ul>
<li>
一个人对应一个地址,并且地址唯一<br/>
</li>
</ul>
</li>
<li id="sec-1_1_1_2">实体类定义 <br/>

<p><br/>
<pre class="src src-java">  <span style="color: #fa8072;">public</span> <span style="color: #fa8072;">class</span> <span style="color: #9acd32; font-weight: bold;">Person11fk</span> {
   <span style="color: #fa8072;">private</span> <span style="color: #9acd32; font-weight: bold;">int</span> <span style="color: #7fffd4; font-weight: bold;">personid</span>;
   <span style="color: #fa8072;">private</span> <span style="color: #9acd32; font-weight: bold;">String</span> <span style="color: #7fffd4; font-weight: bold;">name</span>;
   <span style="color: #fa8072;">private</span> <span style="color: #9acd32; font-weight: bold;">int</span> <span style="color: #7fffd4; font-weight: bold;">age</span>;
   <span style="color: #fa8072;">private</span> <span style="color: #9acd32; font-weight: bold;">Address11fk</span> <span style="color: #7fffd4; font-weight: bold;">address11fk</span>;
   }
  <span style="color: #fa8072;">public</span> <span style="color: #fa8072;">class</span> <span style="color: #9acd32; font-weight: bold;">Address11fk</span> {
   <span style="color: #fa8072;">private</span> <span style="color: #9acd32; font-weight: bold;">int</span> <span style="color: #7fffd4; font-weight: bold;">addressid</span>;
   <span style="color: #fa8072;">private</span> <span style="color: #9acd32; font-weight: bold;">String</span> <span style="color: #7fffd4; font-weight: bold;">addressdetail</span>;
}
</pre>


</p><ul>
<li>
说明<br/>
一个类作为另一个类的属性<br/>
</li>
</ul>
</li>
<li id="sec-1_1_1_3">表模型 <br/>
mysql&gt; desc address11fk; <br/>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>addressid<br/>addressdetail</td>
<td>int(11)<br/>varchar(255)</td>
<td>NO<br/>YES</td>
<td>PRI<br/></td>
<td>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc person11fk;<br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>name<br/>age<br/>addressId</td>
<td>int(11)<br/>varchar(255)<br/>int(11)<br/>int(11)</td>
<td>NO<br/>YES<br/>YES<br/>YES</td>
<td>PRI<br/><br/><br/>UNI</td>
<td>NULL<br/>NULL<br/>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/><br/><br/></td></tr>
</table>
<ul>
<li>
说明<br/>
一个表中的主键在另一个表中<br/>
</li>
</ul>
</li>
<li id="sec-1_1_1_4">SQL脚本 <br/>

<p><br/>
<pre class="src src-sql"><span style="color: #fa8072;">CREATE</span> <span style="color: #fa8072;">TABLE</span> `address11fk` ( 
 `addressid` <span style="color: #9acd32; font-weight: bold;">int</span>(11) <span style="color: #fa8072;">NOT</span> <span style="color: #fa8072;">NULL</span> auto_increment, 
 `addressdetail` <span style="color: #9acd32; font-weight: bold;">varchar</span>(255) <span style="color: #fa8072;">default</span> <span style="color: #fa8072;">NULL</span>, 
 <span style="color: #fa8072;">PRIMARY</span> <span style="color: #fa8072;">KEY</span>    (`addressid`) 
 ) ENGINE=InnoDB AUTO_INCREMENT=2 <span style="color: #fa8072;">DEFAULT</span> CHARSET=gbk; 

 <span style="color: #fa8072;">CREATE</span> <span style="color: #fa8072;">TABLE</span> `person11fk` ( 
  `personid` <span style="color: #9acd32; font-weight: bold;">int</span>(11) <span style="color: #fa8072;">NOT</span> <span style="color: #fa8072;">NULL</span> auto_increment, 
  `<span style="color: #fa8072;">name</span>` <span style="color: #9acd32; font-weight: bold;">varchar</span>(255) <span style="color: #fa8072;">default</span> <span style="color: #fa8072;">NULL</span>, 
  `age` <span style="color: #9acd32; font-weight: bold;">int</span>(11) <span style="color: #fa8072;">default</span> <span style="color: #fa8072;">NULL</span>, 
  `addressId` <span style="color: #9acd32; font-weight: bold;">int</span>(11) <span style="color: #fa8072;">default</span> <span style="color: #fa8072;">NULL</span>, 
  <span style="color: #fa8072;">PRIMARY</span> <span style="color: #fa8072;">KEY</span>    (`personid`), 
  <span style="color: #fa8072;">KEY</span> `FK68A8818F3F45AA77` (`addressId`), 
  <span style="color: #fa8072;">CONSTRAINT</span> `FK68A8818F3F45AA77` <span style="color: #fa8072;">FOREIGN</span> <span style="color: #fa8072;">KEY</span> (`addressId`) <span style="color: #fa8072;">REFERENCES</span> `address11fk` (`addressid`) 
  ) ENGINE=InnoDB AUTO_INCREMENT=2 <span style="color: #fa8072;">DEFAULT</span> CHARSET=gbk; 
</pre>


</p></li>
<li id="sec-1_1_1_5">注: <br/>
<ul>
<li>
在jpa中,无需考虑建表时的各种映射关系,只需要在Entity类中配置相关信息,jpa的配置文件中配置好自动建表,即可自动建立表之间的映射关系<br/>
</li>
</ul>
</li>
<li id="sec-1_1_1_6">映射方法 <br/>

<p><br/>
<pre class="src src-xml">  &lt;<span style="color: #7fffd4; font-weight: bold;">hibernate-mapping</span>&gt; 
        &lt;<span style="color: #7fffd4; font-weight: bold;">class</span> <span style="color: #7fffd4; font-weight: bold;">name</span>=<span style="color: #ffa07a;">"</span><span style="color: #ffa07a;">com.lavasoft.dx._1_1_fk.Address11fk</span><span style="color: #ffa07a;">"</span> <span style="color: #7fffd4; font-weight: bold;">table</span>=<span style="color: #ffa07a;">"</span><span style="color: #ffa07a;">ADDRESS11fk</span><span style="color: #ffa07a;">"</span>&gt; 
                &lt;<span style="color: #7fffd4; font-weight: bold;">id</span> <span style="color: #7fffd4; font-weight: bold;">name</span>=<span style="color: #ffa07a;">"</span><span style="color: #ffa07a;">addressid</span><span style="color: #ffa07a;">"</span>&gt; 
                        &lt;<span style="color: #7fffd4; font-weight: bold;">generator</span> <span style="color: #7fffd4; font-weight: bold;">class</span>=<span style="color: #ffa07a;">"</span><span style="color: #ffa07a;">identity</span><span style="color: #ffa07a;">"</span>/&gt; 
                &lt;/<span style="color: #7fffd4; font-weight: bold;">id</span>&gt; 
                &lt;<span style="color: #7fffd4; font-weight: bold;">property</span> <span style="color: #7fffd4; font-weight: bold;">name</span>=<span style="color: #ffa07a;">"</span><span style="color: #ffa07a;">addressdetail</span><span style="color: #ffa07a;">"</span>/&gt; 
        &lt;/<span style="color: #7fffd4; font-weight: bold;">class</span>&gt; 
 &lt;/<span style="color: #7fffd4; font-weight: bold;">hibernate-mapping</span>&gt;
  &lt;<span style="color: #7fffd4; font-weight: bold;">hibernate-mapping</span>&gt; 
        &lt;<span style="color: #7fffd4; font-weight: bold;">class</span> <span style="color: #7fffd4; font-weight: bold;">name</span>=<span style="color: #ffa07a;">"</span><span style="color: #ffa07a;">com.lavasoft.dx._1_1_fk.Person11fk</span><span style="color: #ffa07a;">"</span> <span style="color: #7fffd4; font-weight: bold;">table</span>=<span style="color: #ffa07a;">"</span><span style="color: #ffa07a;">PERSON11fk</span><span style="color: #ffa07a;">"</span>&gt; 
                &lt;<span style="color: #7fffd4; font-weight: bold;">id</span> <span style="color: #7fffd4; font-weight: bold;">name</span>=<span style="color: #ffa07a;">"</span><span style="color: #ffa07a;">personid</span><span style="color: #ffa07a;">"</span>&gt; 
                        &lt;<span style="color: #7fffd4; font-weight: bold;">generator</span> <span style="color: #7fffd4; font-weight: bold;">class</span>=<span style="color: #ffa07a;">"</span><span style="color: #ffa07a;">identity</span><span style="color: #ffa07a;">"</span>/&gt; 
                &lt;/<span style="color: #7fffd4; font-weight: bold;">id</span>&gt; 
                &lt;<span style="color: #7fffd4; font-weight: bold;">property</span> <span style="color: #7fffd4; font-weight: bold;">name</span>=<span style="color: #ffa07a;">"</span><span style="color: #ffa07a;">name</span><span style="color: #ffa07a;">"</span>/&gt; 
                &lt;<span style="color: #7fffd4; font-weight: bold;">property</span> <span style="color: #7fffd4; font-weight: bold;">name</span>=<span style="color: #ffa07a;">"</span><span style="color: #ffa07a;">age</span><span style="color: #ffa07a;">"</span>/&gt; 
                <span style="color: #add8e6;">&lt;!--</span><span style="color: #add8e6;">&#29992;&#26469;&#26144;&#23556;&#20851;&#32852;PO column&#26159;Address&#22312;&#35813;&#34920;&#20013;&#30340;&#22806;&#38190;&#21015;&#21517;,&#22686;&#21152;unique&#21464;&#25104;&#8220;1-1&#8221;</span><span style="color: #add8e6;">--&gt;</span> 
                &lt;<span style="color: #7fffd4; font-weight: bold;">many-to-one</span> <span style="color: #7fffd4; font-weight: bold;">name</span>=<span style="color: #ffa07a;">"</span><span style="color: #ffa07a;">address11fk</span><span style="color: #ffa07a;">"</span> <span style="color: #7fffd4; font-weight: bold;">column</span>=<span style="color: #ffa07a;">"</span><span style="color: #ffa07a;">addressId</span><span style="color: #ffa07a;">"</span> <span style="color: #7fffd4; font-weight: bold;">unique</span>=<span style="color: #ffa07a;">"</span><span style="color: #ffa07a;">true</span><span style="color: #ffa07a;">"</span>/&gt; 
        &lt;/<span style="color: #7fffd4; font-weight: bold;">class</span>&gt; 
&lt;/<span style="color: #7fffd4; font-weight: bold;">hibernate-mapping</span>&gt;
</pre>


</p><ul>
<li>
注: 在jpa中,此处的配置信息都在Entity上<br/>
<ul>
<li>
例如上面的配置信息<br/>
<ul>
<li>
@Entity<br/>
</li>
<li>
@Table(name="表名")<br/>
</li>
<li>
@Id<br/>
</li>
<li>
@GeneratedValue(strategy=GenerationType.TABLE)<br/>
</li>
<li>
@Column(name="addressdetail",nullable=false,length=32,precision=12)<br/>
</li>
<li>
@ManyToOne(cascade=CascadeType.ALL,mappedBy="多的一方的主键对应名称")<br/>
</li>
<li>
@JoinColumn(name="对应的数据库的列名",referenceColumnName="引用的数据库的列名")<br/>
</li>
</ul>
</li>
</ul>
</li>
<li>
说明<br/>
关联的外键用 many-to-one配置<br/>
&lt;many-to-one name="实体类中关联另一个类的属性" column="该属性对应的外键" unique="true"/&gt; <br/>
</li>
</ul>
</li>
<li id="sec-1_1_1_7">测试方法 <br/>

<p><br/>
<pre class="src src-java"><span style="color: #fa8072;">public</span> <span style="color: #fa8072;">class</span> <span style="color: #9acd32; font-weight: bold;">Test11fk</span> { 
      <span style="color: #fa8072;">public</span> <span style="color: #fa8072;">static</span> <span style="color: #9acd32; font-weight: bold;">void</span> <span style="color: #7fffd4; font-weight: bold;">main</span>(<span style="color: #9acd32; font-weight: bold;">String</span>[] <span style="color: #7fffd4; font-weight: bold;">args</span>){ 
             <span style="color: #9acd32; font-weight: bold;">Person11fk</span> <span style="color: #7fffd4; font-weight: bold;">p1</span>=<span style="color: #fa8072;">new</span> <span style="color: #9acd32; font-weight: bold;">Person11fk</span>(); 

             p1.setAge(21); 
             p1.setName(<span style="color: #ffa07a;">"p1"</span>); 

             <span style="color: #9acd32; font-weight: bold;">Address11fk</span> <span style="color: #7fffd4; font-weight: bold;">add1</span>=<span style="color: #fa8072;">new</span> <span style="color: #9acd32; font-weight: bold;">Address11fk</span>(); 
             add1.setAddressdetail(<span style="color: #ffa07a;">"&#37073;&#24030;&#24066;&#32463;&#19977;&#36335;"</span>); 

             p1.setAddress11fk(add1); 

             <span style="color: #9acd32; font-weight: bold;">Session</span> <span style="color: #7fffd4; font-weight: bold;">session</span>= HibernateUtil.getCurrentSession(); 
             <span style="color: #9acd32; font-weight: bold;">Transaction</span> <span style="color: #7fffd4; font-weight: bold;">tx</span>=session.beginTransaction(); 
             session.save(add1); 
             session.save(p1); 
             tx.commit(); 
             HibernateUtil.closeSession(); 
     } 
}
</pre>


</p></li>
</ul>
</div>

</div>

<div id="outline-container-1_1_2" class="outline-4">
<h4 id="sec-1_1_2"><span class="section-number-4">1.1.2</span> 主键 </h4>
<div class="outline-text-4" id="text-1_1_2">

<ul>
<li id="sec-1_1_2_1">模型 <br/>
<ul>
<li>
一个人对应一个地址<br/>
</li>
</ul>
</li>
<li id="sec-1_1_2_2">实体 <br/>
public class Person11pk { <br/>
private int personid; <br/>
private String name; <br/>
private int age; <br/>
private Address11pk address11pk; <br/>
}  <br/>
public class Address11pk { <br/>
private int addressid; <br/>
private String addressdetail; <br/>
}<br/>
<ul>
<li>
说明<br/>
同一对一外键关联,一个类作为另一个类的属性<br/>
</li>
</ul>
</li>
<li id="sec-1_1_2_3">表模型 <br/>
mysql&gt; desc address11pk; <br/>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>addressid<br/>addressdetail</td>
<td>int(11)<br/>varchar(255)</td>
<td>NO<br/>YES</td>
<td>PRI<br/></td>
<td>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc person11pk; <br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>name<br/>age</td>
<td>int(11)<br/>varchar(255)<br/>int(11)</td>
<td>NO<br/>YES<br/>YES</td>
<td>PRI<br/><br/></td>
<td><br/>NULL<br/>NULL</td>
<td><br/><br/></td></tr>
</table>
<ul>
<li>
说明<br/>
同一对一外键关联相比,一个表的主键不再出现在另一个表中<br/>
</li>
</ul>
</li>
<li id="sec-1_1_2_4">生成的sql语句 <br/>
CREATE TABLE `address11pk` ( <br/>
`addressid` int(11) NOT NULL auto<sub>increment</sub>, <br/>
`addressdetail` varchar(255) default NULL, <br/>
PRIMARY KEY  (`addressid`) <br/>
) ENGINE=InnoDB AUTO<sub>INCREMENT</sub>=2 DEFAULT CHARSET=gbk; <br/>
CREATE TABLE `person11pk` ( <br/>
`presonid` int(11) NOT NULL, <br/>
`name` varchar(255) default NULL, <br/>
`age` int(11) default NULL, <br/>
PRIMARY KEY  (`presonid`), <br/>
KEY `FK68A882C591BB393E` (`presonid`), <br/>
CONSTRAINT `FK68A882C591BB393E` FOREIGN KEY (`presonid`) REFERENCES `address11pk` (`addressid`) <br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk; <br/>
<ul>
<li>
说明 <br/>
CONSTRAINT 关联名称 FOREIGN KEY('本表的主键名称') REFERENCES '在另一个表中的主键'<br/>
</li>
</ul>
</li>
<li id="sec-1_1_2_5">映射方法 <br/>
<ul>
<li>
配置实例 <br/>
&lt;id name="personid"&gt; <br/>
&lt;!&ndash;基于主键关联时，主键生成策略是foreign，表明根据关联类生成主键&ndash;&gt; <br/>
&lt;generator class="foreign"&gt; <br/>
&lt;!&ndash;关联持久化类的属性名&ndash;&gt; <br/>
&lt;param name="property"&gt;address11pk&lt;/param&gt; <br/>
&lt;/generator&gt; <br/>
&lt;/id&gt; <br/>
&hellip;&hellip; <br/>
&lt;!&ndash;用于映射1-1关联&ndash;&gt; <br/>
&lt;one-to-one name="address11pk" constrained="true"/&gt; <br/>

<p><br/>
</p></li>
</ul>

<p>&lt;hibernate-mapping&gt; <br/>
&lt;class name="com.lavasoft.dx.<sub>1</sub><sub>1</sub><sub>pk</sub>.Person11pk" table="PERSON11pk"&gt; <br/>
&lt;id name="personid" column="presonid"&gt; <br/>
&lt;!&ndash;基于主键关联时，主键生成策略是foreign，表明根据关联类生成主键&ndash;&gt; <br/>
&lt;generator class="foreign"&gt; <br/>
&lt;!&ndash;关联持久化类的属性名&ndash;&gt; <br/>
&lt;param name="property"&gt;address11pk&lt;/param&gt; <br/>
&lt;/generator&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="name"/&gt; <br/>
&lt;property name="age"/&gt; <br/>
&lt;!&ndash;用于映射1-1关联&ndash;&gt; <br/>
&lt;one-to-one name="address11pk" constrained="true"/&gt; <br/>
&lt;/class&gt; <br/>
&lt;/hibernate-mapping&gt;   <br/>
&lt;hibernate-mapping&gt; <br/>
&lt;class name="com.lavasoft.dx.<sub>1</sub><sub>1</sub><sub>pk</sub>.Address11pk" table="ADDRESS11pk"&gt; <br/>
&lt;id name="addressid"&gt; <br/>
&lt;generator class="identity"/&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="addressdetail"/&gt; <br/>
&lt;/class&gt; <br/>
&lt;/hibernate-mapping&gt; <br/>
</p><ul>
<li>
说明<br/>
一个表正常配置,另一个表配置 &lt;one-to-one name="关联到的另一个表的主键" constrained="true"/&gt;<br/>
</li>
<li>
关联的配置 &lt;generator class="foreign"&gt;&lt;param name="property"&gt;关联到的另一个表的主键&lt;/param&gt;&lt;/generator&gt;<br/>
</li>
</ul>
</li>
<li id="sec-1_1_2_6">测试方法 <br/>
public class Test11pk { <br/>
public static void main(String[] args){ <br/>
Person11pk p1=new Person11pk(); <br/>

<p><br/>
p1.setAge(21); <br/>
p1.setName("p1"); <br/>
</p>
<p><br/>
Address11pk add1=new Address11pk(); <br/>
add1.setAddressdetail("郑州市经三路"); <br/>
</p>
<p><br/>
p1.setAddress11pk(add1); <br/>
</p>
<p><br/>
Session session= HibernateUtil.getCurrentSession(); <br/>
Transaction tx=session.beginTransaction(); <br/>
session.save(add1); <br/>
session.save(p1); <br/>
tx.commit(); <br/>
HibernateUtil.closeSession(); <br/>
} <br/>
} <br/>
</p><ul>
<li>

<p><br/>
</p></li>
</ul>
</li>
</ul>
</div>

</div>

<div id="outline-container-1_1_3" class="outline-4">
<h4 id="sec-1_1_3"><span class="section-number-4">1.1.3</span> 连接表 </h4>
<div class="outline-text-4" id="text-1_1_3">

<ul>
<li id="sec-1_1_3_1">模型 <br/>
一个人对应一个地址<br/>
</li>
<li id="sec-1_1_3_2">实体 <br/>
public class Person11tab { <br/>
private int personid; <br/>
private String name; <br/>
private int age; <br/>
private Address11tab address11tab; <br/>
}  <br/>
public class Address11tab { <br/>
private int addressid; <br/>
private String addressdetail; <br/>
}<br/>
</li>
<li id="sec-1_1_3_3">表模型 <br/>
mysql&gt; desc address11tab; <br/>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>addressid<br/>addressdetail</td>
<td>int(11)<br/>varchar(255)</td>
<td>NO<br/>YES</td>
<td>PRI<br/></td>
<td>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc join11tab; <br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>address11tab</td>
<td>int(11)<br/>int(11)</td>
<td>NO<br/>YES</td>
<td>PRI<br/>UNI</td>
<td><br/>NULL</td>
<td><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc person11tab; <br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>name<br/>age</td>
<td>int(11)<br/>varchar(255)<br/>int(11)</td>
<td>NO<br/>YES<br/>YES</td>
<td>PRI<br/><br/></td>
<td>NULL<br/>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/><br/></td></tr>
</table>
<ul>
<li>
说明<br/>
新增一个包含2个表主键的连接表<br/>
</li>
</ul>
</li>
<li id="sec-1_1_3_4">SQL脚本 <br/>
CREATE TABLE `join11tab` ( <br/>
`personid` int(11) NOT NULL, <br/>
`address11tab` int(11) default NULL, <br/>
PRIMARY KEY  (`personid`), <br/>
UNIQUE KEY `address11tab` (`address11tab`), <br/>
KEY `FK6B44BE20C4CC3D33` (`address11tab`), <br/>
KEY `FK6B44BE209049BB1F` (`personid`), <br/>
CONSTRAINT `FK6B44BE209049BB1F` FOREIGN KEY (`personid`) REFERENCES `person11tab` (`personid`), <br/>
CONSTRAINT `FK6B44BE20C4CC3D33` FOREIGN KEY (`address11tab`) REFERENCES `address11tab` (`addressid`) <br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk; <br/>

<p><br/>
CREATE TABLE `address11tab` ( <br/>
`addressid` int(11) NOT NULL auto<sub>increment</sub>, <br/>
`addressdetail` varchar(255) default NULL, <br/>
PRIMARY KEY  (`addressid`) <br/>
) ENGINE=InnoDB AUTO<sub>INCREMENT</sub>=2 DEFAULT CHARSET=gbk; <br/>
</p>
<p><br/>
CREATE TABLE `person11tab` ( <br/>
`personid` int(11) NOT NULL auto<sub>increment</sub>, <br/>
`name` varchar(255) default NULL, <br/>
`age` int(11) default NULL, <br/>
PRIMARY KEY  (`personid`) <br/>
) ENGINE=InnoDB AUTO<sub>INCREMENT</sub>=2 DEFAULT CHARSET=gbk; <br/>
</p></li>
<li id="sec-1_1_3_5">映射方法 <br/>
<ul>
<li>
配置实例 <br/>
&lt;!&ndash;使用join元素显式确定链接表&ndash;&gt; <br/>
&lt;join table="join11tab"&gt; <br/>
&lt;key column="personid"/&gt; <br/>
&lt;!&ndash;映射1-1关联属性，其中unique=“true”属性确定为“1-1”&ndash;&gt; <br/>
&lt;many-to-one name="address11tab" unique="true"/&gt; <br/>
&lt;/join&gt; <br/>
</li>
</ul>

<p>&lt;hibernate-mapping&gt; <br/>
&lt;class name="com.lavasoft.dx.<sub>1</sub><sub>1</sub><sub>tab</sub>.Person11tab" table="PERSON11tab"&gt; <br/>
&lt;id name="personid"&gt; <br/>
&lt;generator class="identity"/&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="name"/&gt; <br/>
&lt;property name="age"/&gt; <br/>
&lt;!&ndash;使用join元素显式确定链接表&ndash;&gt; <br/>
&lt;join table="join11tab"&gt; <br/>
&lt;key column="personid"/&gt; <br/>
&lt;!&ndash;映射1-1关联属性，其中unique=“true”属性确定为“1-1”&ndash;&gt; <br/>
&lt;many-to-one name="address11tab" unique="true"/&gt; <br/>
&lt;/join&gt; <br/>
&lt;/class&gt; <br/>
&lt;/hibernate-mapping&gt; <br/>
&lt;hibernate-mapping&gt; <br/>
&lt;class name="com.lavasoft.dx.<sub>1</sub><sub>1</sub><sub>tab</sub>.Address11tab" table="ADDRESS11tab"&gt; <br/>
&lt;id name="addressid"&gt; <br/>
&lt;generator class="identity"/&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="addressdetail"/&gt; <br/>
&lt;/class&gt; <br/>
&lt;/hibernate-mapping&gt; <br/>
</p><ul>
<li>
说明<br/>
在一个表中配置另一个join表的信息<br/>
&lt;join table="连接表"&gt;<br/>
&lt;key column="连接表中的主键"/&gt;<br/>
&lt;many-to-one name="连接表中关联到另一个表" unique="true"/&gt;<br/>
&lt;/join&gt;<br/>
</li>
</ul>
</li>
<li id="sec-1_1_3_6">测试方法 <br/>
public class Test11tab { <br/>
public static void main(String[] args){ <br/>
Person11tab p1=new Person11tab(); <br/>

<p><br/>
p1.setAge(21); <br/>
p1.setName("p1"); <br/>
</p>
<p><br/>
Address11tab add1=new Address11tab(); <br/>
add1.setAddressdetail("郑州市经三路"); <br/>
</p>
<p><br/>
p1.setAddress11tab(add1); <br/>
</p>
<p><br/>
Session session= HibernateUtil.getCurrentSession(); <br/>
Transaction tx=session.beginTransaction(); <br/>
session.save(add1); <br/>
session.save(p1); <br/>
tx.commit(); <br/>
HibernateUtil.closeSession(); <br/>
} <br/>
} <br/>
</p></li>
</ul>
</div>
</div>

</div>

<div id="outline-container-1_2" class="outline-3">
<h3 id="sec-1_2"><span class="section-number-3">1.2</span> 一对多 </h3>
<div class="outline-text-3" id="text-1_2">


</div>

<div id="outline-container-1_2_1" class="outline-4">
<h4 id="sec-1_2_1"><span class="section-number-4">1.2.1</span> 外键 </h4>
<div class="outline-text-4" id="text-1_2_1">

<ul>
<li id="sec-1_2_1_1">模型 <br/>
一个人对应多个地址<br/>
</li>
<li id="sec-1_2_1_2">实体类 <br/>
public class Person1nfk implements Serializable { <br/>
private int personid; <br/>
private String name; <br/>
private int age; <br/>
private Set addresses=new HashSet(); <br/>
}  <br/>
public class Address1nfk implements Serializable { <br/>
private int addressid; <br/>
private String addressdetail; <br/>
}<br/>
<ul>
<li>
说明<br/>
一个类的Set集合来作为另一个类的属性<br/>
</li>
</ul>
</li>
<li id="sec-1_2_1_3">表模型 <br/>
mysql&gt; desc address<sub>1nfk</sub>; <br/>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>addressid<br/>addressdetail<br/>personid</td>
<td>int(11)<br/>varchar(255)<br/>int(11)</td>
<td>NO<br/>YES<br/>YES</td>
<td>PRI<br/><br/>MUL</td>
<td>NULL<br/>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc person<sub>1nfk</sub>; <br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>name<br/>age</td>
<td>int(11)<br/>varchar(255)<br/>int(11)</td>
<td>NO<br/>YES<br/>YES</td>
<td>PRI<br/><br/></td>
<td>NULL<br/>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/><br/></td></tr>
</table>
<ul>
<li>
说明<br/>
一的一方对应表的主键在另一个表(集合类对应表)中<br/>

<p><br/>
</p></li>
</ul>
</li>
<li id="sec-1_2_1_4">SQL脚本 <br/>
CREATE TABLE `address<sub>1nfk`</sub> ( <br/>
`addressid` int(11) NOT NULL auto<sub>increment</sub>, <br/>
`addressdetail` varchar(255) default NULL, <br/>
`addresses` int(11) default NULL, <br/>
PRIMARY KEY  (`addressid`), <br/>
KEY `FK9B93456DC08D1667` (`addresses`), <br/>
CONSTRAINT `FK9B93456DC08D1667` FOREIGN KEY (`addresses`) REFERENCES `person<sub>1nfk`</sub> (`personid`) <br/>
) ENGINE=InnoDB AUTO<sub>INCREMENT</sub>=3 DEFAULT CHARSET=gbk; <br/>

<p><br/>
</p><ul>
<li>
 CREATE TABLE `person<sub>1nfk`</sub> ( <br/>
`personid` int(11) NOT NULL auto<sub>increment</sub>, <br/>
`name` varchar(255) default NULL, <br/>
`age` int(11) default NULL, <br/>
PRIMARY KEY  (`personid`) <br/>
) ENGINE=InnoDB AUTO<sub>INCREMENT</sub>=2 DEFAULT CHARSET=gbk; <br/>

<p><br/>
</p></li>
</ul>
</li>
<li id="sec-1_2_1_5">映射方法 <br/>
<ul>
<li>
配置实例<br/>
&lt;!&ndash;映射集合属性，关联到持久化类,inverse="false"表示主控端在Person1nfk端，lazy="false"表示不采用延迟加载&ndash;&gt; <br/>
&lt;set name="addresses" <br/>
table="ADDRESS<sub>1nfk</sub>" <br/>
cascade="all" <br/>
&gt; <br/>
&lt;!&ndash;确定关联的外键列&ndash;&gt; <br/>
&lt;key column="personid"/&gt; <br/>
&lt;!&ndash;用以映射到关联类属性&ndash;&gt; <br/>
&lt;one-to-many class="com.lavasoft.dx.<sub>1</sub><sub>n</sub><sub>fk</sub>.Address1nfk"/&gt; <br/>
&lt;/set&gt; <br/>
&lt;hibernate-mapping&gt; <br/>
&lt;class name="com.lavasoft.dx.<sub>1</sub><sub>n</sub><sub>fk</sub>.Person1nfk" table="PERSON<sub>1nfk</sub>"&gt; <br/>
&lt;id name="personid"&gt; <br/>
&lt;generator class="identity"/&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="name"/&gt; <br/>
&lt;property name="age"/&gt; <br/>
&lt;!&ndash;映射集合属性，关联到持久化类,inverse="false"表示主控端在Person1nfk端，lazy="false"表示不采用延迟加载&ndash;&gt; <br/>
&lt;set name="addresses" <br/>
table="ADDRESS<sub>1nfk</sub>" <br/>
cascade="all" <br/>
&gt; <br/>
&lt;!&ndash;确定关联的外键列&ndash;&gt; <br/>
&lt;key column="personid"/&gt; <br/>
&lt;!&ndash;用以映射到关联类属性&ndash;&gt; <br/>
&lt;one-to-many class="com.lavasoft.dx.<sub>1</sub><sub>n</sub><sub>fk</sub>.Address1nfk"/&gt; <br/>
&lt;/set&gt; <br/>
&lt;/class&gt; <br/>
</li>
</ul>

<p>&lt;/hibernate-mapping&gt; <br/>
&lt;hibernate-mapping&gt; <br/>
&lt;class name="com.lavasoft.dx.<sub>1</sub><sub>n</sub><sub>fk</sub>.Address1nfk" table="ADDRESS<sub>1nfk</sub>"&gt; <br/>
&lt;id name="addressid"&gt; <br/>
&lt;generator class="identity"/&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="addressdetail"/&gt; <br/>
&lt;/class&gt; <br/>
&lt;/hibernate-mapping&gt; <br/>
</p><ul>
<li>
说明<br/>
将一个类的集合作为另一个类的属性进行配置<br/>
&lt;set name="连接到的另一个类的名称" table="另一个类对应的表名" cascade="all"&gt;<br/>
&lt;key column="关联到的另一个表的主键"/&gt;<br/>
&lt;one-to-many class="关联到的另一个表名称"/&gt;<br/>
&lt;/set&gt;<br/>
另一个类正常设置<br/>
</li>
</ul>
</li>
<li id="sec-1_2_1_6">测试方法 <br/>
public class Test<sub>1nfk</sub> { <br/>
public static void main(String[] args){ <br/>
Address1nfk add1=new Address1nfk(); <br/>
Address1nfk add2=new Address1nfk(); <br/>
Person1nfk p=new Person1nfk(); <br/>

<p><br/>
add1.setAddressdetail("郑州市经三路"); <br/>
add2.setAddressdetail("合肥市宿州路"); <br/>
p.setName("wang"); <br/>
p.setAge(30); <br/>
p.getAddresses().add(add1); <br/>
p.getAddresses().add(add2); <br/>
</p>
<p><br/>
Session session= HibernateUtil.getCurrentSession(); <br/>
Transaction tx=session.beginTransaction(); <br/>
session.save(add1); <br/>
session.save(add2); <br/>
session.save(p); <br/>
tx.commit(); <br/>
HibernateUtil.closeSession(); <br/>
} <br/>
} <br/>
</p></li>
</ul>
</div>

</div>

<div id="outline-container-1_2_2" class="outline-4">
<h4 id="sec-1_2_2"><span class="section-number-4">1.2.2</span> 连接表 </h4>
<div class="outline-text-4" id="text-1_2_2">

<ul>
<li id="sec-1_2_2_1">模型 <br/>
一个人对应多个地址<br/>
</li>
<li id="sec-1_2_2_2">实体类 <br/>
public class Person1ntab { <br/>
private int personid; <br/>
private String name; <br/>
private int age; <br/>
private Set addresses=new HashSet(); <br/>
}  <br/>
public class Address1nfk implements Serializable { <br/>
private int addressid; <br/>
private String addressdetail; <br/>
}<br/>
<ul>
<li>
说明<br/>
一个类的Set集合来作为另一个类的属性<br/>
</li>
</ul>
</li>
<li id="sec-1_2_2_3">表模型 <br/>
mysql&gt; desc join<sub>1ntab</sub>; <br/>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>addressid</td>
<td>int(11)<br/>int(11)</td>
<td>NO<br/>NO</td>
<td>PRI<br/>PRI</td>
<td><br/></td>
<td><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc person<sub>1ntab</sub>; <br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>name<br/>age</td>
<td>int(11)<br/>varchar(255)<br/>int(11)</td>
<td>NO<br/>YES<br/>YES</td>
<td>PRI<br/><br/></td>
<td>NULL<br/>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc address<sub>1ntab</sub>; <br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>addressid<br/>addressdetail</td>
<td>int(11)<br/>varchar(255)</td>
<td>NO<br/>YES</td>
<td>PRI<br/></td>
<td>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/></td></tr>
</table>
<ul>
<li>
连接表中的2个列都是主键<br/>
</li>
</ul>
</li>
<li id="sec-1_2_2_4">SQL脚本 <br/>
<ul>
<li>
<i>* Formatted on 2007/08/21 10:58 (QP5 v5.50) *</i> <br/>
</li>
</ul>

<p>CREATE TABLE `address<sub>1ntab`</sub> ( <br/>
`addressid` int(11) NOT NULL auto<sub>increment</sub>, <br/>
`addressdetail` varchar(255) default NULL, <br/>
PRIMARY KEY  (`addressid`) <br/>
) ENGINE=InnoDB AUTO<sub>INCREMENT</sub>=3 DEFAULT CHARSET=gbk; <br/>
</p><ul>
<li>
<i>* Formatted on 2007/08/21 10:58 (QP5 v5.50) *</i> <br/>
</li>
</ul>

<p>CREATE TABLE `join<sub>1ntab`</sub> ( <br/>
`personid` int(11) NOT NULL, <br/>
`addressid` int(11) NOT NULL, <br/>
PRIMARY KEY  (`personid`,`addressid`), <br/>
UNIQUE KEY `addressid` (`addressid`), <br/>
KEY `FK6B6078C3C8DF5BFF` (`personid`), <br/>
KEY `FK6B6078C3C2B11347` (`addressid`), <br/>
CONSTRAINT `FK6B6078C3C2B11347` FOREIGN KEY (`addressid`) REFERENCES `address<sub>1ntab`</sub> (`addressid`), <br/>
CONSTRAINT `FK6B6078C3C8DF5BFF` FOREIGN KEY (`personid`) REFERENCES `person<sub>1ntab`</sub> (`personid`) <br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk; <br/>
</p><ul>
<li>
<i>* Formatted on 2007/08/21 10:58 (QP5 v5.50) *</i> <br/>
</li>
</ul>

<p>CREATE TABLE `person<sub>1ntab`</sub> ( <br/>
`personid` int(11) NOT NULL auto<sub>increment</sub>, <br/>
`name` varchar(255) default NULL, <br/>
`age` int(11) default NULL, <br/>
PRIMARY KEY  (`personid`) <br/>
) ENGINE=InnoDB AUTO<sub>INCREMENT</sub>=2 DEFAULT CHARSET=gbk; <br/>
</p></li>
<li id="sec-1_2_2_5">映射方法 <br/>
&lt;hibernate-mapping&gt; <br/>
&lt;class name="com.lavasoft.dx.<sub>1</sub><sub>n</sub><sub>tab</sub>.Person1ntab" table="PERSON<sub>1ntab</sub>"&gt; <br/>
&lt;id name="personid"&gt; <br/>
&lt;generator class="identity"/&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="name"/&gt; <br/>
&lt;property name="age"/&gt; <br/>
&lt;!&ndash;映射集合属性，join<sub>1ntab是连接表表名&ndash</sub>;&gt; <br/>
&lt;set name="addresses" <br/>
table="join<sub>1ntab</sub>" <br/>
&gt; <br/>
&lt;!&ndash;“column="personid"”确定PERSON<sub>1ntab表关联到连接表的外键列名&ndash</sub>;&gt; <br/>
&lt;key column="personid"/&gt; <br/>
&lt;!&ndash;“column="addressid"”关联PERSON<sub>1ntab表的Address1ntab对象的id在连接表中的列名&ndash</sub>;&gt; <br/>
&lt;!&ndash;“unique="true"表示1-N，Person1ntab是1，Address1ntab是多”&ndash;&gt; <br/>
&lt;many-to-many <br/>
column="addressid" <br/>
unique="true" <br/>
class="com.lavasoft.dx.<sub>1</sub><sub>n</sub><sub>tab</sub>.Address1ntab"/&gt; <br/>
&lt;/set&gt; <br/>
&lt;/class&gt; <br/>
&lt;/hibernate-mapping&gt; <br/>
&lt;hibernate-mapping&gt; <br/>
&lt;class name="com.lavasoft.dx.<sub>1</sub><sub>n</sub><sub>tab</sub>.Address1ntab" table="ADDRESS<sub>1ntab</sub>"&gt; <br/>
&lt;id name="addressid"&gt; <br/>
&lt;generator class="identity"/&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="addressdetail"/&gt; <br/>
&lt;/class&gt; <br/>
&lt;/hibernate-mapping&gt; <br/>
<ul>
<li>
说明<br/>
将join表设置为其中一个类的set属性<br/>
</li>
</ul>

<p>&lt;set name="另一个多的类名称" table="连接类名称"&gt;<br/>
&lt;key column="一的一方的主键名称"/&gt;<br/>
&lt;many-to-many column="多的一方的主键" unique="true" class="多的一方对应表名称"/&gt;<br/>
&lt;/set&gt;<br/>
</p></li>
<li id="sec-1_2_2_6">测试方法 <br/>
public class Test<sub>1ntab</sub> { <br/>
public static void main(String[] args){ <br/>
Address1ntab add1=new Address1ntab(); <br/>
Address1ntab add2=new Address1ntab(); <br/>
Address1ntab add3=new Address1ntab(); <br/>
Person1ntab p1=new Person1ntab(); <br/>
Person1ntab p2=new Person1ntab(); <br/>

<p><br/>
add1.setAddressdetail("郑州市经三路"); <br/>
add2.setAddressdetail("合肥市宿州路"); <br/>
add3.setAddressdetail("北京市长安路"); <br/>
p1.setName("wang"); <br/>
p1.setAge(30); <br/>
p2.setName("lee"); <br/>
p2.setAge(50); <br/>
</p>
<p><br/>
p1.getAddresses().add(add1); <br/>
p1.getAddresses().add(add2); <br/>
+p2.getAddresses().add(add2); <br/>
p2.getAddresses().add(add3); <br/>
</p>
<p><br/>
Session session= HibernateUtil.getCurrentSession(); <br/>
Transaction tx=session.beginTransaction(); <br/>
session.save(add1); <br/>
session.save(add2); <br/>
session.save(add3); <br/>
session.save(p1); <br/>
session.save(p2); <br/>
tx.commit(); <br/>
HibernateUtil.closeSession(); <br/>
} <br/>
} <br/>
</p></li>
</ul>
</div>
</div>

</div>

<div id="outline-container-1_3" class="outline-3">
<h3 id="sec-1_3"><span class="section-number-3">1.3</span> 多对一 </h3>
<div class="outline-text-3" id="text-1_3">


</div>

<div id="outline-container-1_3_1" class="outline-4">
<h4 id="sec-1_3_1"><span class="section-number-4">1.3.1</span> 外键 </h4>
<div class="outline-text-4" id="text-1_3_1">

<ul>
<li id="sec-1_3_1_1">模型 <br/>
多个人对应一个地址<br/>
</li>
<li id="sec-1_3_1_2">实体类 <br/>
public class Personn1fk { <br/>
private int personid; <br/>
private String name; <br/>
private int age; <br/>
private Addressn1fk addressn1fk; <br/>
}  <br/>
public class Addressn1fk { <br/>
private int addressid; <br/>
private String addressdetail; <br/>
}<br/>
<ul>
<li>
说明<br/>
一对应的类中包含多方对应的类作为其属性<br/>
</li>
</ul>
</li>
<li id="sec-1_3_1_3">表模型 <br/>
mysql&gt; desc address<sub>n1kf</sub>;<br/>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>addressid<br/>addressdetail</td>
<td>int(11)<br/>varchar(255)</td>
<td>NO<br/>YES</td>
<td>PRI<br/></td>
<td>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc person<sub>n1kf</sub>;<br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>name<br/>age<br/>addressId</td>
<td>int(11)<br/>varchar(255)<br/>int(11)<br/>int(11)</td>
<td>NO<br/>YES<br/>YES<br/>YES</td>
<td>PRI<br/><br/><br/>MUL</td>
<td>NULL<br/>NULL<br/>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/><br/><br/></td></tr>
</table>
<ul>
<li>
说明<br/>
在多方的表中含有一方的主键作为其属性<br/>
</li>
</ul>
</li>
<li id="sec-1_3_1_4">SQL脚本 <br/>
CREATE TABLE `address<sub>n1kf`</sub> (<br/>
`addressid` int(11) NOT NULL auto<sub>increment</sub>,<br/>
`addressdetail` varchar(255) default NULL,<br/>
PRIMARY KEY  (`addressid`)<br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk;<br/>

<p><br/>
DROP TABLE IF EXISTS `person<sub>n1kf`</sub>;<br/>
</p>
<p><br/>
CREATE TABLE `person<sub>n1kf`</sub> (<br/>
`personid` int(11) NOT NULL auto<sub>increment</sub>,<br/>
`name` varchar(255) default NULL,<br/>
`age` int(11) default NULL,<br/>
`addressId` int(11) default NULL,<br/>
PRIMARY KEY  (`personid`),<br/>
KEY `FK4571AF54A2A3EE48` (`addressId`),<br/>
CONSTRAINT `FK4571AF54A2A3EE48` FOREIGN KEY (`addressId`) REFERENCES `address<sub>n1kf`</sub> (`addressid`)<br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk;<br/>
</p></li>
<li id="sec-1_3_1_5">映射方法 <br/>
&lt;hibernate-mapping&gt;<br/>
&lt;class name="com.lavasoft.dx.<sub>n</sub><sub>1</sub><sub>fk</sub>.Personn1fk" table="PERSON<sub>n1fk</sub>"&gt;<br/>
&lt;id name="personid"&gt;<br/>
&lt;generator class="identity"/&gt;<br/>
&lt;/id&gt;<br/>
&lt;property name="name"/&gt;<br/>
&lt;property name="age"/&gt;<br/>
&lt;!&ndash;用来映射关联PO column是Address在该表中的外键列名&ndash;&gt;<br/>
&lt;many-to-one name="addressn1fk" column="addressId"/&gt;<br/>
&lt;/class&gt;<br/>
&lt;/hibernate-mapping&gt;<br/>
&lt;hibernate-mapping&gt;<br/>
&lt;class name="com.lavasoft.dx.<sub>n</sub><sub>1</sub><sub>fk</sub>.Addressn1fk" table="ADDRESS<sub>n1fk</sub>"&gt;<br/>
&lt;id name="addressid"&gt;<br/>
&lt;generator class="identity"/&gt;<br/>
&lt;/id&gt;<br/>
&lt;property name="addressdetail"/&gt;<br/>
&lt;/class&gt;<br/>
&lt;/hibernate-mapping&gt;<br/>
<ul>
<li>
说明 <br/>
</li>
</ul>

<p>其中一对应类正常配置<br/>
多对应类中用many-to-one配置表之间的关联<br/>
&lt;many-to-one name="关联的一方的表名称" column="一方表的主键"/&gt;<br/>
</p></li>
<li id="sec-1_3_1_6">测试方法 <br/>
public class Test<sub>n1fk</sub> { <br/>
public static void main(String[] args){ <br/>
Personn1fk p1=new Personn1fk(); <br/>
Personn1fk p2=new Personn1fk(); <br/>

<p><br/>
p1.setAge(21); <br/>
p1.setName("p1"); <br/>
</p>
<p><br/>
p2.setAge(23); <br/>
p2.setName("p2"); <br/>
</p>
<p><br/>
Addressn1fk add=new Addressn1fk(); <br/>
add.setAddressdetail("郑州市经三路"); <br/>
</p>
<p><br/>
p1.setAddressn1fk(add); <br/>
p2.setAddressn1fk(add); <br/>
</p>
<p><br/>
Session session=HibernateUtil.getCurrentSession(); <br/>
Transaction tx=session.beginTransaction(); <br/>
session.save(add); <br/>
session.save(p1); <br/>
session.save(p2); <br/>
tx.commit(); <br/>
HibernateUtil.closeSession(); <br/>
} <br/>
}<br/>
</p></li>
</ul>
</div>

</div>

<div id="outline-container-1_3_2" class="outline-4">
<h4 id="sec-1_3_2"><span class="section-number-4">1.3.2</span> 连接表 </h4>
<div class="outline-text-4" id="text-1_3_2">

<ul>
<li id="sec-1_3_2_1">模型 <br/>
多个人对应一个地址<br/>
</li>
<li id="sec-1_3_2_2">实体类 <br/>
public class Personn1tab { <br/>
private int personid; <br/>
private String name; <br/>
private int age; <br/>
private Addressn1tab addressn1tab; <br/>
}  <br/>
public class Addressn1tab { <br/>
private int addressid; <br/>
private String addressdetail; <br/>
}<br/>
<ul>
<li>
说明 <br/>
</li>
</ul>

<p>一方的类作为多方类的属性<br/>
</p></li>
<li id="sec-1_3_2_3">表模型 <br/>
mysql&gt; desc address<sub>n1tab</sub>; <br/>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>addressid<br/>addressdetail</td>
<td>int(11)<br/>varchar(255)</td>
<td>NO<br/>YES</td>
<td>PRI<br/></td>
<td>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc join<sub>n1tab</sub>; <br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>addressn1tab</td>
<td>int(11)<br/>int(11)</td>
<td>NO<br/>YES</td>
<td>PRI<br/>MUL</td>
<td><br/>NULL</td>
<td><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc person<sub>n1tab</sub>; <br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>name<br/>age</td>
<td>int(11)<br/>varchar(255)<br/>int(11)</td>
<td>NO<br/>YES<br/>YES</td>
<td>PRI<br/><br/></td>
<td>NULL<br/>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/><br/></td></tr>
</table>
＋说明<br/>
多方和一方表正常<br/>
增加连接表,列为多和一方表的主键<br/>
</li>
<li id="sec-1_3_2_4">SQL脚本 <br/>
CREATE TABLE `address<sub>n1tab`</sub> ( <br/>
`addressid` int(11) NOT NULL auto<sub>increment</sub>, <br/>
`addressdetail` varchar(255) default NULL, <br/>
PRIMARY KEY  (`addressid`) <br/>
) ENGINE=InnoDB AUTO<sub>INCREMENT</sub>=2 DEFAULT CHARSET=gbk; <br/>

<p><br/>
CREATE TABLE `join<sub>n1tab`</sub> ( <br/>
`personid` int(11) NOT NULL, <br/>
`address11fk` int(11) default NULL, <br/>
PRIMARY KEY  (`personid`), <br/>
KEY `FKAC780AAADAE3A82C` (`personid`), <br/>
KEY `FKAC780AAAC6242A64` (`address11fk`), <br/>
CONSTRAINT `FKAC780AAAC6242A64` FOREIGN KEY (`address11fk`) REFERENCES `address<sub>n1tab`</sub> (`addressid`), <br/>
CONSTRAINT `FKAC780AAADAE3A82C` FOREIGN KEY (`personid`) REFERENCES `person<sub>n1tab`</sub> (`personid`) <br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk; <br/>
</p>
<p><br/>
CREATE TABLE `person<sub>n1tab`</sub> ( <br/>
`personid` int(11) NOT NULL auto<sub>increment</sub>, <br/>
`name` varchar(255) default NULL, <br/>
`age` int(11) default NULL, <br/>
PRIMARY KEY  (`personid`) <br/>
) ENGINE=InnoDB AUTO<sub>INCREMENT</sub>=3 DEFAULT CHARSET=gbk <br/>
</p></li>
<li id="sec-1_3_2_5">映射方法 <br/>
&lt;hibernate-mapping&gt; <br/>
&lt;class name="com.lavasoft.dx.<sub>n</sub><sub>1</sub><sub>tab</sub>.Personn1tab" table="PERSON<sub>n1tab</sub>"&gt; <br/>
&lt;id name="personid"&gt; <br/>
&lt;generator class="identity"/&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="name"/&gt; <br/>
&lt;property name="age"/&gt; <br/>
&lt;!&ndash;使用join元素显式确定链接表&ndash;&gt; <br/>
&lt;join table="join<sub>n1tab</sub>"&gt; <br/>
&lt;!&ndash;映射关联所用的外键&ndash;&gt; <br/>
&lt;key column="personid"/&gt; <br/>
&lt;many-to-one name="addressn1tab"/&gt; <br/>
&lt;/join&gt; <br/>
&lt;/class&gt; <br/>
&lt;/hibernate-mapping&gt; <br/>
&lt;hibernate-mapping&gt; <br/>
&lt;class name="com.lavasoft.dx.<sub>n</sub><sub>1</sub><sub>tab</sub>.Addressn1tab" table="ADDRESS<sub>n1tab</sub>"&gt; <br/>
&lt;id name="addressid"&gt; <br/>
&lt;generator class="identity"/&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="addressdetail"/&gt; <br/>
&lt;/class&gt; <br/>
&lt;/hibernate-mapping&gt; <br/>
<ul>
<li>
说明<br/>
连接表,在多的一方用join配置<br/>
&lt;join table="连接表的表名称"&gt;<br/>
&lt;key column="连接表的主键"/&gt;<br/>
&lt;many-to-one name="管理到的一方的表名称"/&gt;<br/>
&lt;/join&gt;<br/>
一方的表正常配置<br/>
</li>
</ul>
</li>
<li id="sec-1_3_2_6">测试方法 <br/>
public class Test<sub>n1tab</sub> { <br/>
public static void main(String[] args){ <br/>
Personn1tab p1=new Personn1tab(); <br/>
Personn1tab p2=new Personn1tab(); <br/>

<p><br/>
p1.setAge(21); <br/>
p1.setName("p1"); <br/>
</p>
<p><br/>
p2.setAge(23); <br/>
p2.setName("p2"); <br/>
</p>
<p><br/>
Addressn1tab add=new Addressn1tab(); <br/>
add.setAddressdetail("郑州市经三路"); <br/>
</p>
<p><br/>
p1.setAddressn1tab(add); <br/>
p2.setAddressn1tab(add); <br/>
</p>
<p><br/>
Session session=HibernateUtil.getCurrentSession(); <br/>
Transaction tx=session.beginTransaction(); <br/>
session.save(add); <br/>
session.save(p1); <br/>
session.save(p2); <br/>
tx.commit(); <br/>
HibernateUtil.closeSession(); <br/>
} <br/>
} <br/>
</p></li>
</ul>
</div>
</div>

</div>

<div id="outline-container-1_4" class="outline-3">
<h3 id="sec-1_4"><span class="section-number-3">1.4</span> 多对多 </h3>
<div class="outline-text-3" id="text-1_4">

<ul>
<li id="sec-1_4_1">模型 <br/>
一个人对应多个地址和多个人对应一个地址<br/>
</li>
<li id="sec-1_4_2">实体类 <br/>
public class Personnn { <br/>
private int personid; <br/>
private String name; <br/>
private int age; <br/>
private Set addresses=new HashSet(); <br/>
}  <br/>
public class Addressnn { <br/>
private int addressid; <br/>
private String addressdetail; <br/>
}<br/>
<ul>
<li>
说明<br/>
</li>
</ul>

<p>其中一个类中包含另一个类的Set集合<br/>
</p></li>
<li id="sec-1_4_3">表模型 <br/>
mysql&gt; desc person<sub>nn</sub>; <br/>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>name<br/>age</td>
<td>int(11)<br/>varchar(255)<br/>int(11)</td>
<td>NO<br/>YES<br/>YES</td>
<td>PRI<br/><br/></td>
<td>NULL<br/>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc join<sub>nn</sub>; <br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>addressid</td>
<td>int(11)<br/>int(11)</td>
<td>NO<br/>NO</td>
<td>PRI<br/>PRI</td>
<td><br/></td>
<td><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc person<sub>nn</sub>; <br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>name<br/>age</td>
<td>int(11)<br/>varchar(255)<br/>int(11)</td>
<td>NO<br/>YES<br/>YES</td>
<td>PRI<br/><br/></td>
<td>NULL<br/>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/><br/></td></tr>
</table>
<ul>
<li>
说明<br/>
使用连接表,2个表中的主键都在连接表中为主键<br/>
</li>
</ul>
</li>
<li id="sec-1_4_4">SQL脚本 <br/>
<ul>
<li>
 <i>* Formatted on 2007/08/21 11:13 (QP5 v5.50) *</i><br/>
CREATE TABLE `address<sub>nn`</sub> ( <br/>
`addressid` int(11) NOT NULL auto<sub>increment</sub>, <br/>
`addressdetail` varchar(255) default NULL, <br/>
PRIMARY KEY  (`addressid`) <br/>
</li>
</ul>

<p>) ENGINE=InnoDB AUTO<sub>INCREMENT</sub>=4 DEFAULT CHARSET=gbk; <br/>
</p>
<p><br/>
</p><ul>
<li>
 <i>* Formatted on 2007/08/21 11:14 (QP5 v5.50) *</i> <br/>
</li>
</ul>

<p>CREATE TABLE `join<sub>nn`</sub> ( <br/>
`personid` int(11) NOT NULL, <br/>
`addressid` int(11) NOT NULL, <br/>
PRIMARY KEY  (`personid`,`addressid`), <br/>
KEY `FKAAB98CF5E008E752` (`personid`), <br/>
KEY `FKAAB98CF5239F6A16` (`addressid`), <br/>
CONSTRAINT `FKAAB98CF5239F6A16` FOREIGN KEY (`addressid`) REFERENCES `address<sub>nn`</sub> (`addressid`), <br/>
CONSTRAINT `FKAAB98CF5E008E752` FOREIGN KEY (`personid`) REFERENCES `person<sub>nn`</sub> (`personid`) <br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk; <br/>
</p>
<p><br/>
</p><ul>
<li>
<i>* Formatted on 2007/08/21 11:14 (QP5 v5.50) *</i> <br/>
</li>
</ul>

<p>CREATE TABLE `person<sub>nn`</sub> ( <br/>
`personid` int(11) NOT NULL auto<sub>increment</sub>, <br/>
`name` varchar(255) default NULL, <br/>
`age` int(11) default NULL, <br/>
PRIMARY KEY  (`personid`) <br/>
) ENGINE=InnoDB AUTO<sub>INCREMENT</sub>=3 DEFAULT CHARSET=gbk; <br/>
</p></li>
<li id="sec-1_4_5">映射方法 <br/>
&lt;hibernate-mapping&gt;<br/>
&lt;class name="com.lavasoft.dx.<sub>n</sub><sub>n</sub>.Personnn" table="PERSON<sub>nn</sub>"&gt;<br/>
&lt;id name="personid"&gt;<br/>
&lt;generator class="identity"/&gt;<br/>
&lt;/id&gt;<br/>
&lt;property name="name"/&gt;<br/>
&lt;property name="age"/&gt;<br/>
&lt;!&ndash;映射集合属性，join<sub>1ntab是连接表表名&ndash</sub>;&gt;<br/>
&lt;set name="addresses"<br/>
table="join<sub>nn</sub>"<br/>
&gt;<br/>
&lt;!&ndash;“column="personid"”确定PERSON<sub>1ntab表关联到连接表的外键列名&ndash</sub>;&gt;<br/>
&lt;key column="personid"/&gt;<br/>
&lt;!&ndash;“column="addressid"”关联PERSON<sub>1ntab表的Address1ntab对象的id在连接表中的列名&ndash</sub>;&gt;<br/>
&lt;many-to-many<br/>
column="addressid"<br/>
class="com.lavasoft.dx.<sub>n</sub><sub>n</sub>.Addressnn"/&gt;<br/>
&lt;/set&gt;<br/>
&lt;/class&gt;<br/>
&lt;/hibernate-mapping&gt;<br/>
&lt;hibernate-mapping&gt;<br/>
&lt;class name="com.lavasoft.dx.<sub>n</sub><sub>n</sub>.Addressnn" table="ADDRESS<sub>nn</sub>"&gt;<br/>
&lt;id name="addressid"&gt;<br/>
&lt;generator class="identity"/&gt;<br/>
&lt;/id&gt;<br/>
&lt;property name="addressdetail"/&gt;<br/>
&lt;/class&gt;<br/>
&lt;/hibernate-mapping&gt;<br/>
<ul>
<li>
说明<br/>
一个类的Set集合来作为另一个类的属性<br/>
&lt;set name="另一个表的名称" table="连接表名称"&gt;<br/>
&lt;key column="连接表的主键"/&gt;<br/>
&lt;many-to-many column="另一个表的主键名称" class="另一个表名称"/&gt;<br/>
&lt;/set&gt;<br/>
另一个类正常设置<br/>
</li>
</ul>
</li>
<li id="sec-1_4_6">测试方法 <br/>
public class Test<sub>nn</sub> {<br/>
public static void main(String[] args){<br/>
Addressnn add1=new Addressnn();<br/>
Addressnn add2=new Addressnn();<br/>
Addressnn add3=new Addressnn();<br/>
Personnn p1=new Personnn();<br/>
Personnn p2=new Personnn();<br/>

<p><br/>
add1.setAddressdetail("郑州市经三路");<br/>
add2.setAddressdetail("合肥市宿州路");<br/>
add3.setAddressdetail("北京市长安路");<br/>
p1.setName("wang");<br/>
p1.setAge(30);<br/>
p2.setName("lee");<br/>
p2.setAge(50);<br/>
</p>
<p><br/>
p1.getAddresses().add(add1);<br/>
p1.getAddresses().add(add2);<br/>
p2.getAddresses().add(add2);<br/>
p2.getAddresses().add(add3);<br/>
</p>
<p><br/>
Session session= HibernateUtil.getCurrentSession();<br/>
Transaction tx=session.beginTransaction();<br/>
session.save(add1);<br/>
session.save(add2);<br/>
session.save(add3);<br/>
session.save(p1);<br/>
session.save(p2);<br/>
tx.commit();<br/>
HibernateUtil.closeSession();<br/>
}<br/>
}<br/>
</p></li>
</ul>
</div>
</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> 双向关联 </h2>
<div class="outline-text-2" id="text-2">


</div>

<div id="outline-container-2_1" class="outline-3">
<h3 id="sec-2_1"><span class="section-number-3">2.1</span> 一对一 </h3>
<div class="outline-text-3" id="text-2_1">


</div>

<div id="outline-container-2_1_1" class="outline-4">
<h4 id="sec-2_1_1"><span class="section-number-4">2.1.1</span> 外键 </h4>
<div class="outline-text-4" id="text-2_1_1">

<ul>
<li id="sec-2_1_1_1">模型 <br/>
一个人对应一个地址<br/>
是一对多外键的特例,多的一方添加唯一性约束<br/>
</li>
<li id="sec-2_1_1_2">实体类 <br/>
public class Person implements java.io.Serializable { <br/>
private Long id; <br/>
private String name; <br/>
private Address address;<br/>
}<br/>
public class Address implements java.io.Serializable { <br/>
private Long id; <br/>
private Person person; <br/>
private String detail;<br/>
}<br/>
<ul>
<li>
说明 <br/>
实体类都实现Serializable接口<br/>
都添加Long类型属性<br/>
</li>
</ul>
</li>
<li id="sec-2_1_1_3">表模型 <br/>
<a href="#sec-2_1_1_3"><img src="200812091228754114406.png"/></a><br/>
</li>
<li id="sec-2_1_1_4">SQL脚本 <br/>
Create table address<br/>
(<br/>
id                   bigint not null auto<sub>increment</sub> comment 'ID',<br/>
detail               varchar(120) not null comment '详细地址',<br/>
personid             bigint comment '人的ID',<br/>
primary key (id)<br/>
)<br/>
type = InnoDB;<br/>
alter table address comment '地址';<br/>
Create table person<br/>
(<br/>
id                   bigint not null auto<sub>increment</sub> comment 'ID',<br/>
name                 varchar(24) not null comment '姓名',<br/>
primary key (id)<br/>
)<br/>
type = InnoDB;<br/>
alter table person comment '人';<br/>
alter table address add constraint FK<sub>Reference</sub><sub>4</sub> foreign key (personid)<br/>
references person (id) on delete restrict on update restrict;<br/>
<ul>
<li>
说明<br/>
主键都是Long类型id<br/>
一个表中有能关联对方表的外键<br/>
</li>
</ul>
</li>
<li id="sec-2_1_1_5">映射方法 <br/>
&lt;class name="entity.Person" table="person"&gt; <br/>
&lt;id name="id" type="java.lang.Long"&gt; <br/>
&lt;column name="id" /&gt; <br/>
&lt;generator class="identity" /&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="name" type="java.lang.String"&gt; <br/>
&lt;column name="name" length="24" not-null="true"&gt; <br/>
&lt;comment&gt;姓名&lt;/comment&gt; <br/>
&lt;/column&gt; <br/>
&lt;/property&gt; <br/>
&lt;one-to-one name="address" cascade="all" /&gt; <br/>
&lt;/class&gt; <br/>
&lt;class name="entity.Address" table="address" catalog="testdb"&gt; <br/>
&lt;id name="id" type="java.lang.Long"&gt; <br/>
&lt;column name="id" /&gt; <br/>
&lt;generator class="identity" /&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="detail" type="java.lang.String"&gt; <br/>
&lt;column name="detail" length="120" not-null="true"&gt; <br/>
&lt;comment&gt;详细地址&lt;/comment&gt; <br/>
&lt;/column&gt; <br/>
&lt;/property&gt; <br/>
&lt;many-to-one name="person" class="entity.Person" <br/>
fetch="select" unique="true"&gt; <br/>
&lt;column name="personid"&gt; <br/>
&lt;comment&gt;人的ID&lt;/comment&gt; <br/>
&lt;/column&gt; <br/>
&lt;/many-to-one&gt; <br/>
&lt;/class&gt; <br/>
<ul>
<li>
说明<br/>
<ul>
<li>
包含关联另一个表的主键 配置如下<br/>
&lt;one-to-one name="关联的一方的表名称" cascade="true"/&gt;<br/>
</li>
<li>
在另一个表中配置 many-to-one<br/>
&lt;many-to-one name="关联到的另一个表名称" class="关联到的另一个表的实体类名称" fetch="select" unique="true"&gt;<br/>
&lt;column name=="关联到的另一个表的主键"/&gt;<br/>
&lt;comment&gt;在表中对应列的名称&lt;/comment&gt;<br/>
</li>
</ul>

<p>&lt;/many-to-one&gt;<br/>
</p></li>
</ul>
</li>
<li id="sec-2_1_1_6">测试方法 <br/>
public class Test { <br/>
public static void main(String[] args) { <br/>
savePerson(); <br/>
} <br/>

<p><br/>
public static void savePerson() { <br/>
Person person = new Person("张三"); <br/>
Address address = new Address("XX街X号"); <br/>
person.setAddress(address); <br/>
address.setPerson(person); <br/>
</p>
<p><br/>
Session session = HibernateSessionFactory.getSession(); <br/>
Transaction tx = session.beginTransaction(); <br/>
session.save(person); <br/>
tx.commit(); <br/>
} <br/>
}<br/>
</p></li>
</ul>
</div>

</div>

<div id="outline-container-2_1_2" class="outline-4">
<h4 id="sec-2_1_2"><span class="section-number-4">2.1.2</span> 主键 </h4>
<div class="outline-text-4" id="text-2_1_2">

<ul>
<li id="sec-2_1_2_1">模型 <br/>
一个人对应一个地址<br/>
</li>
<li id="sec-2_1_2_2">实体类 <br/>
public class Person implements java.io.Serializable { <br/>

<p><br/>
private Long id; <br/>
private String name; <br/>
private Address address;<br/>
} <br/>
public class Address implements java.io.Serializable { <br/>
private Long id; <br/>
private Person person; <br/>
private String detail;<br/>
}<br/>
</p><ul>
<li>
两个类互为对方的属性<br/>
</li>
</ul>
</li>
<li id="sec-2_1_2_3">表模型 <br/>
<a href="#sec-2_1_2_3"><img src="200812081228749820593.png"/></a><br/>
</li>
<li id="sec-2_1_2_4">SQL脚本 <br/>
Create table address <br/>
( <br/>
id                                     bigint not null comment 'ID', <br/>
detail                             varchar(120) not null comment '详细地址', <br/>
primary key (id) <br/>
) <br/>
type = InnoDB; <br/>
Create table person <br/>
( <br/>
id                                bigint not null auto<sub>increment</sub> comment 'ID', <br/>
name                                 varchar(24) not null comment '姓名', <br/>
primary key (id) <br/>
) <br/>
type = InnoDB; <br/>

<p><br/>
alter table person comment '人'; <br/>
</p>
<p><br/>
alter table address add constraint FK<sub>Reference</sub><sub>2</sub> foreign key (id) <br/>
references person (id) on delete restrict on update restrict;<br/>
</p><ul>
<li>
说明<br/>
2个表中都建立 id列作为其主键<br/>
</li>
</ul>
</li>
<li id="sec-2_1_2_5">映射方法 <br/>
<ul>
<li>
 &lt;class name="entity.Person" table="person"&gt; <br/>
&lt;id name="id" type="java.lang.Long"&gt; <br/>
&lt;column name="id" /&gt; <br/>
&lt;generator class="identity" /&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="name" type="java.lang.String"&gt; <br/>
&lt;column name="name" length="24" not-null="true"&gt; <br/>
&lt;comment&gt;姓名&lt;/comment&gt; <br/>
&lt;/column&gt; <br/>
&lt;/property&gt; <br/>
&lt;!&ndash; cascade="all"：在保存person对象的时候，级联保存person对象关联的address对象    &ndash;&gt; <br/>
&lt;one-to-one name="address" cascade="all" /&gt; <br/>
&lt;/class&gt; <br/>
</li>
</ul>

<p>&lt;class name="entity.Address" table="address" catalog="mydb"&gt; <br/>
&lt;id name="id" type="java.lang.Long"&gt; <br/>
&lt;column name="id" /&gt; <br/>
&lt;!&ndash; class="foreign": 一对一主键映射中，使用另外一个相关联的对象的标识符 &ndash;&gt; <br/>
&lt;generator class="foreign"&gt; <br/>
&lt;param name="property"&gt;person&lt;/param&gt; <br/>
&lt;/generator&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="detail" type="java.lang.String"&gt; <br/>
&lt;column name="detail" length="120" not-null="true"&gt; <br/>
&lt;comment&gt;详细地址&lt;/comment&gt; <br/>
&lt;/column&gt; <br/>
&lt;/property&gt; <br/>
&lt;!&ndash; 表示在address表存在一个外键约束，外键参考相关联的表person &ndash;&gt; <br/>
&lt;one-to-one name="person" constrained="true" /&gt; <br/>
&lt;/class&gt; <br/>
</p><ul>
<li>
说明<br/>
其中一个类配置 one-to-one <br/>
&lt;one-to-one name="另一个表名称" cascade="true"/&gt;<br/>
另一个也配置 one-to-one<br/>
&lt;one-to-one name="另一个表名称'" constrained="true"/&gt;<br/>
</li>
</ul>
</li>
</ul>
</div>

</div>

<div id="outline-container-2_1_3" class="outline-4">
<h4 id="sec-2_1_3"><span class="section-number-4">2.1.3</span> 连接表 </h4>
<div class="outline-text-4" id="text-2_1_3">

<ul>
<li id="sec-2_1_3_1">模型 <br/>
一个人对应一个地址<br/>
</li>
<li id="sec-2_1_3_2">实体类 <br/>
public class Person11tabsx { <br/>
private int personid; <br/>
private String name; <br/>
private int age; <br/>
private Address11tabsx address11tabsx; <br/>
}  <br/>
public class Address11tabsx { <br/>
private int addressid; <br/>
private String addressdetail; <br/>
private Person11tabsx person11tabsx; <br/>
}<br/>
<ul>
<li>
说明<br/>
2个类都互为对方的属性<br/>
</li>
</ul>
</li>
<li id="sec-2_1_3_3">表模型 <br/>
mysql&gt; desc person11tabsx; <br/>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>name<br/>age</td>
<td>int(11)<br/>varchar(255)<br/>int(11)</td>
<td>NO<br/>YES<br/>YES</td>
<td>PRI<br/><br/></td>
<td>NULL<br/>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc join11tabsx; <br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>addressid<br/>personid</td>
<td>int(11)<br/>int(11)</td>
<td>NO<br/>NO</td>
<td>UNI<br/>PRI</td>
<td><br/></td>
<td><br/></td></tr>
</table>

<p><br/>
</p>
<p><br/>
mysql&gt; desc address11tabsx; <br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>addressid<br/>addressdetail</td>
<td>int(11)<br/>varchar(255)</td>
<td>NO<br/>YES</td>
<td>PRI<br/></td>
<td>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/></td></tr>
</table>
<ul>
<li>
说明<br/>
建立一个连接表,其中一个表的主键在连接表中做主键<br/>
</li>
</ul>
</li>
<li id="sec-2_1_3_4">SQL脚本 <br/>
CREATE TABLE `person11tabsx` ( <br/>
`personid` int(11) NOT NULL auto<sub>increment</sub>, <br/>
`name` varchar(255) default NULL, <br/>
`age` int(11) default NULL, <br/>
PRIMARY KEY  (`personid`) <br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk; <br/>

<p><br/>
CREATE TABLE `address11tabsx` ( <br/>
`addressid` int(11) NOT NULL auto<sub>increment</sub>, <br/>
`addressdetail` varchar(255) default NULL, <br/>
PRIMARY KEY  (`addressid`) <br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk;<br/>
</p>
<p><br/>
CREATE TABLE `join11tabsx` (<br/>
`addressid` int(11) NOT NULL,<br/>
`personid` int(11) NOT NULL,<br/>
PRIMARY KEY  (`personid`),<br/>
UNIQUE KEY `addressid` (`addressid`),<br/>
UNIQUE KEY `personid` (`personid`),<br/>
KEY `FKF4AA80E44327AAB6` (`personid`),<br/>
KEY `FKF4AA80E460C0C9F0` (`addressid`),<br/>
CONSTRAINT `FKF4AA80E460C0C9F0` FOREIGN KEY (`addressid`) REFERENCES `address11tabsx` (`addressid`),<br/>
CONSTRAINT `FKF4AA80E44327AAB6` FOREIGN KEY (`personid`) REFERENCES `person11tabsx` (`personid`)<br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk;<br/>
</p></li>
<li id="sec-2_1_3_5">映射方法 <br/>
&lt;hibernate-mapping&gt; <br/>
&lt;class name="com.lavasoft.sx.<sub>1</sub><sub>1</sub><sub>tab</sub>.Person11tabsx" table="PERSON11tabsx"&gt; <br/>
&lt;id name="personid"&gt; <br/>
&lt;generator class="identity"/&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="name"/&gt; <br/>
&lt;property name="age"/&gt; <br/>
&lt;join table="join11tabsx" <br/>
optional="true"&gt; <br/>
&lt;key column="personid" <br/>
unique="true"/&gt; <br/>
&lt;many-to-one name="address11tabsx" <br/>
column="addressid" <br/>
not-null="true" <br/>
unique="true"/&gt; <br/>
&lt;/join&gt; <br/>
&lt;/class&gt; <br/>
&lt;/hibernate-mapping&gt; <br/>

<p><br/>
&lt;hibernate-mapping&gt; <br/>
&lt;class name="com.lavasoft.sx.<sub>1</sub><sub>1</sub><sub>tab</sub>.Address11tabsx" table="ADDRESS11tabsx"&gt; <br/>
&lt;id name="addressid"&gt; <br/>
&lt;generator class="identity"/&gt; <br/>
&lt;/id&gt; <br/>
&lt;property name="addressdetail"/&gt; <br/>
&lt;join table="join11tabsx" <br/>
optional="true" <br/>
inverse="true"&gt; <br/>
&lt;key column="addressid" <br/>
unique="true"/&gt; <br/>
&lt;many-to-one name="person11tabsx" column="personid" <br/>
not-null="true" unique="true"/&gt; <br/>
&lt;/join&gt; <br/>
&lt;/class&gt; <br/>
&lt;/hibernate-mapping&gt; <br/>
</p><ul>
<li>
说明 <br/>
<ul>
<li>
其中一个类配置 many-to-one<br/>
&lt;many-to-one name="另一个表名称" column="另一个表中主键" not-null="true" unique="true"/&gt;<br/>
</li>
<li>
另一个类配置 join<br/>
&lt;join table="join表名称" optional="true" inverse="true"&gt;<br/>
&lt;key column="连接表主键" unique="true"/&gt;<br/>
&lt;many-to-one name="另一个表名称" column="另一个表中主键" not-null="true" unique="true"/&gt;<br/>
&lt;/join&gt;  <br/>
</li>
</ul>
</li>
</ul>
</li>
<li id="sec-2_1_3_6">测试方法 <br/>
public class Test11tabsx { <br/>
public static void main(String[] args){ <br/>
Address11tabsx add = new Address11tabsx(); <br/>
Person11tabsx p = new Person11tabsx(); <br/>

<p><br/>
add.setAddressdetail("郑州市经三路"); <br/>
p.setAge(12); <br/>
p.setName("wudalang"); <br/>
</p>
<p><br/>
add.setPerson11tabsx(p); <br/>
p.setAddress11tabsx(add); <br/>
</p>
<p><br/>
Session session = HibernateUtil.getCurrentSession(); <br/>
Transaction tx = session.beginTransaction(); <br/>
session.saveOrUpdate(p); <br/>
session.saveOrUpdate(add); <br/>
tx.commit(); <br/>
HibernateUtil.closeSession(); <br/>
} <br/>
} <br/>
</p></li>
</ul>
</div>
</div>

</div>

<div id="outline-container-2_2" class="outline-3">
<h3 id="sec-2_2"><span class="section-number-3">2.2</span> 一对多 </h3>
<div class="outline-text-3" id="text-2_2">


</div>

<div id="outline-container-2_2_1" class="outline-4">
<h4 id="sec-2_2_1"><span class="section-number-4">2.2.1</span> 外键 </h4>
<div class="outline-text-4" id="text-2_2_1">

<ul>
<li id="sec-2_2_1_1">模型 <br/>
一个人对应多个地址<br/>
</li>
<li id="sec-2_2_1_2">实体类 <br/>
public class Person1nfksx implements Serializable {<br/>
private int personid;<br/>
private String name;<br/>
private int age;<br/>
private Set addresses=new HashSet();<br/>
} <br/>
public class Address1nfksx implements Serializable {<br/>
private int addressid;<br/>
private String addressdetail;<br/>
private Person1nfksx person1nfkSx;<br/>
}<br/>
<ul>
<li>
说明<br/>
一对应的类中包含多方对应类的Set集合作为其属性<br/>
多的一方对应的类包含一的主键<br/>
</li>
</ul>
</li>
<li id="sec-2_2_1_3">表模型 <br/>
mysql&gt; desc person<sub>1nfksx</sub>;<br/>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>name<br/>age</td>
<td>int(11)<br/>varchar(255)<br/>int(11)</td>
<td>NO<br/>YES<br/>YES</td>
<td>PRI<br/><br/></td>
<td>NULL<br/>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc address<sub>1nfksx</sub>;<br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>addressid<br/>addressdetail<br/>personid</td>
<td>int(11)<br/>varchar(255)<br/>int(11)</td>
<td>NO<br/>YES<br/>NO</td>
<td>PRI<br/><br/>MUL</td>
<td>NULL<br/>NULL<br/></td>
<td>auto<sub>increment</sub><br/><br/></td></tr>
</table>
<ul>
<li>
说明<br/>
一的一方对应表的主键在多的一方<br/>
</li>
</ul>
</li>
<li id="sec-2_2_1_4">SQL脚本 <br/>
CREATE TABLE `address<sub>1nfk`</sub> (<br/>
`addressid` int(11) NOT NULL auto<sub>increment</sub>,<br/>
`addressdetail` varchar(255) default NULL,<br/>
`personid` int(11) default NULL,<br/>
PRIMARY KEY  (`addressid`),<br/>
KEY `FK9B93456DA6D6C1F5` (`personid`),<br/>
CONSTRAINT `FK9B93456DA6D6C1F5` FOREIGN KEY (`personid`) REFERENCES `person<sub>1nfk`</sub> (`personid`)<br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk;<br/>

<p><br/>
CREATE TABLE `person<sub>1nfk`</sub> (<br/>
`personid` int(11) NOT NULL auto<sub>increment</sub>,<br/>
`name` varchar(255) default NULL,<br/>
`age` int(11) default NULL,<br/>
PRIMARY KEY  (`personid`)<br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk;<br/>
</p></li>
<li id="sec-2_2_1_5">映射方法 <br/>
&lt;hibernate-mapping&gt;<br/>
&lt;class name="com.lavasoft.sx.<sub>1</sub><sub>n</sub><sub>fk</sub>.Person1nfksx" table="PERSON<sub>1nfksx</sub>"&gt;<br/>
&lt;id name="personid"&gt;<br/>
&lt;generator class="identity"/&gt;<br/>
&lt;/id&gt;<br/>
&lt;property name="name"/&gt;<br/>
&lt;property name="age"/&gt;<br/>
&lt;!&ndash;映射集合属性，关联到持久化类&ndash;&gt;<br/>
&lt;set name="addresses" inverse="true" cascade="all"&gt;<br/>
&lt;!&ndash;column用于指定外键列名&ndash;&gt;<br/>
&lt;key column="personid" not-null="true"/&gt;<br/>
&lt;!&ndash;映射关联类&ndash;&gt;<br/>
&lt;one-to-many class="com.lavasoft.sx.<sub>1</sub><sub>n</sub><sub>fk</sub>.Address1nfksx"/&gt;<br/>
&lt;/set&gt;<br/>
&lt;/class&gt;<br/>
&lt;/hibernate-mapping&gt;<br/>
&lt;hibernate-mapping&gt;<br/>
&lt;class name="com.lavasoft.sx.<sub>1</sub><sub>n</sub><sub>fk</sub>.Address1nfksx" table="ADDRESS<sub>1nfksx</sub>"&gt;<br/>
&lt;id name="addressid"&gt;<br/>
&lt;generator class="identity"/&gt;<br/>
&lt;/id&gt;<br/>
&lt;property name="addressdetail"/&gt;<br/>
&lt;!&ndash;映射关联属性，column属性指定外键列名&ndash;&gt;<br/>
&lt;many-to-one name="person1nfk"<br/>
class="com.lavasoft.sx.<sub>1</sub><sub>n</sub><sub>fk</sub>.Person1nfksx"<br/>
fetch="select"<br/>
cascade="save-update"&gt;<br/>
&lt;column name="personid" not-null="true"/&gt;<br/>
&lt;/many-to-one&gt;<br/>
&lt;/class&gt;<br/>
&lt;/hibernate-mapping&gt;<br/>
<ul>
<li>
 说明<br/>
<ul>
<li>
 多的一方在一中用set配置<br/>
&lt;set name="关联的一方的表名称" inverse="true" cascade="true"&gt;<br/>
&lt;key column="关联到的另一个表的主键" not-null="true"/&gt;<br/>
&lt;one-to-many class="关联到的另一个表的实体类名称"/&gt;<br/>
&lt;/set&gt;<br/>
</li>
<li>
 一的一方包含多方的主键,用many-to-one配置<br/>
</li>
</ul>

<p>&lt;many-to-one name="关联到的另一个表名称" class="关联到的另一个表的实体类名称" fetch="true" cascade="save-update"&gt;<br/>
&lt;column name="关联到的另一个表的主键" not-null="true"/&gt; <br/>
</p></li>
</ul>

<p>&lt;/many-to-one&gt;<br/>
</p></li>
<li id="sec-2_2_1_6">测试方法 <br/>
public class Test<sub>1nfksx</sub> {<br/>
public static void main(String[] args){<br/>
Address1nfksx add1=new Address1nfksx();<br/>
Address1nfksx add2=new Address1nfksx();<br/>
Person1nfksx p=new Person1nfksx();<br/>

<p><br/>
add1.setAddressdetail("郑州市经三路");<br/>
add2.setAddressdetail("合肥市宿州路");<br/>
p.setName("wang");<br/>
p.setAge(30);<br/>
</p>
<p><br/>
p.getAddresses().add(add1);<br/>
p.getAddresses().add(add2);<br/>
add1.setPerson1nfk(p);<br/>
add2.setPerson1nfk(p);<br/>
</p>
<p><br/>
Session session= HibernateUtil.getCurrentSession();<br/>
Transaction tx=session.beginTransaction();<br/>
session.save(p);<br/>
session.saveOrUpdate(add1);<br/>
session.saveOrUpdate(add2);<br/>
tx.commit();<br/>
HibernateUtil.closeSession();<br/>
}<br/>
}<br/>
</p></li>
</ul>
</div>

</div>

<div id="outline-container-2_2_2" class="outline-4">
<h4 id="sec-2_2_2"><span class="section-number-4">2.2.2</span> 连接表 </h4>
<div class="outline-text-4" id="text-2_2_2">

<ul>
<li id="sec-2_2_2_1">模型 <br/>
一个人对应多个地址<br/>
</li>
<li id="sec-2_2_2_2">实体类 <br/>
public class Person1ntabsx {<br/>
private int personid;<br/>
private String name;<br/>
private int age;<br/>
private Set addresses=new HashSet();<br/>
} <br/>
public class Address1ntabsx {<br/>
private int addressid;<br/>
private String addressdetail;<br/>
private Person1ntabsx person1ntabsx;<br/>
}<br/>
<ul>
<li>
说明<br/>
同一对多外键关联双向<br/>
</li>
</ul>
</li>
<li id="sec-2_2_2_3">表模型 <br/>
mysql&gt; desc person<sub>1ntabsx</sub>;<br/>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>name<br/>age</td>
<td>int(11)<br/>varchar(255)<br/>int(11)</td>
<td>NO<br/>YES<br/>YES</td>
<td>PRI<br/><br/></td>
<td>NULL<br/>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc address<sub>1ntabsx</sub>;<br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>addressid<br/>addressdetail</td>
<td>int(11)<br/>varchar(255)</td>
<td>NO<br/>YES</td>
<td>PRI<br/></td>
<td>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc join<sub>1ntabsx</sub>;<br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>addressid<br/>personid</td>
<td>int(11)<br/>int(11)</td>
<td>NO<br/>NO</td>
<td>PRI<br/>PRI</td>
<td><br/></td>
<td><br/></td></tr>
</table>
<ul>
<li>
 说明<br/>
2个表的主键都在新连接表中作主键<br/>
</li>
</ul>
</li>
<li id="sec-2_2_2_4">SQL脚本 <br/>
CREATE TABLE `address<sub>1ntabsx`</sub> (<br/>
`addressid` int(11) NOT NULL auto<sub>increment</sub>,<br/>
`addressdetail` varchar(255) default NULL,<br/>
PRIMARY KEY  (`addressid`)<br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk;<br/>
CREATE TABLE `person<sub>1ntabsx`</sub> (<br/>
`personid` int(11) NOT NULL auto<sub>increment</sub>,<br/>
`name` varchar(255) default NULL,<br/>
`age` int(11) default NULL,<br/>
PRIMARY KEY  (`personid`)<br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk;<br/>
CREATE TABLE `join<sub>1ntabsx`</sub> (<br/>
`addressid` int(11) NOT NULL,<br/>
`personid` int(11) NOT NULL,<br/>
PRIMARY KEY  (`personid`,`addressid`),<br/>
KEY `FK8F869F61F93DDD6` (`personid`),<br/>
KEY `FK8F869F61FC0F682A` (`addressid`),<br/>
CONSTRAINT `FK8F869F61FC0F682A` FOREIGN KEY (`addressid`) REFERENCES `address<sub>1ntabsx`</sub> (`addressid`),<br/>
CONSTRAINT `FK8F869F61F93DDD6` FOREIGN KEY (`personid`) REFERENCES `person<sub>1ntabsx`</sub> (`personid`)<br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk;<br/>
</li>
<li id="sec-2_2_2_5">映射方法 <br/>
&lt;hibernate-mapping&gt;<br/>
&lt;class name="com.lavasoft.sx.<sub>1</sub><sub>n</sub><sub>tab</sub>.Person1ntabsx" table="PERSON<sub>1ntabsx</sub>"&gt;<br/>
&lt;id name="personid"&gt;<br/>
&lt;generator class="identity"/&gt;<br/>
&lt;/id&gt;<br/>
&lt;property name="name"/&gt;<br/>
&lt;property name="age"/&gt;<br/>
&lt;!&ndash;映射集合属性，关联到持久化类&ndash;&gt;<br/>
&lt;!&ndash;table="join<sub>1ntabsx</sub>"指定了连接表的名字&ndash;&gt;<br/>
&lt;set name="addresses"<br/>
table="join<sub>1ntabsx</sub>"<br/>
cascade="all"&gt;<br/>
&lt;!&ndash;column="personid"指定连接表中关联当前实体类的列名&ndash;&gt;<br/>
&lt;key column="personid" not-null="true"/&gt;<br/>
&lt;!&ndash;unique="true"表示当前实体类是"1",不是"n"&ndash;&gt;<br/>
&lt;many-to-many column="addressid"<br/>
unique="true"<br/>
class="com.lavasoft.sx.<sub>1</sub><sub>n</sub><sub>tab</sub>.Address1ntabsx"/&gt;<br/>
&lt;/set&gt;<br/>
&lt;/class&gt;<br/>
&lt;/hibernate-mapping&gt;<br/>

<p><br/>
&lt;hibernate-mapping&gt;<br/>
&lt;class name="com.lavasoft.sx.<sub>1</sub><sub>n</sub><sub>tab</sub>.Address1ntabsx"<br/>
table="ADDRESS<sub>1ntabsx</sub>"&gt;<br/>
&lt;id name="addressid"&gt;<br/>
&lt;generator class="identity"/&gt;<br/>
&lt;/id&gt;<br/>
&lt;property name="addressdetail"/&gt;<br/>
&lt;!&ndash;映射关联属性，column属性指定外键列名&ndash;&gt;<br/>
&lt;join   table="join<sub>1ntabsx</sub>"<br/>
inverse="true"<br/>
optional="true"&gt;<br/>
&lt;key column="addressid"/&gt;<br/>
&lt;many-to-one name="person1ntabsx"<br/>
column="personid"<br/>
cascade="all"<br/>
not-null="true"/&gt;<br/>
&lt;/join&gt;<br/>
&lt;/class&gt;<br/>
&lt;/hibernate-mapping&gt;<br/>
</p><ul>
<li>
说明<br/>
<ul>
<li>
 一对应一方中包含多方的Set集合属性,用set配置<br/>
</li>
</ul>

<p>&lt;set name="关联到的另一个表名称" table="连接表名称" cascade="all"&gt;<br/>
&lt;key column="连接表的主键" not-null="true"/&gt;<br/>
&lt;many-to-many column="关联到的另一个表的主键" unique="true" class="关联到的另一个表的实体类名称"/&gt;<br/>
&lt;/set&gt;<br/>
</p><ul>
<li>
多的一方配置join<br/>
</li>
</ul>

<p>&lt;join table="连接表名称" inverse="true" optional="true"&gt;<br/>
&lt;key column="连接表中关联到另一个表的主键"/&gt;<br/>
&lt;many-to-one name="连接到的另一个类的名称" column="关联到的另一个表的主键" cascade="all" not-null="true"/&gt;<br/>
&lt;/join&gt;<br/>
</p></li>
</ul>
</li>
<li id="sec-2_2_2_6">测试方法 <br/>
public class Test<sub>1ntabsx</sub> {<br/>
public static void main(String[] args){<br/>
Address1ntabsx add1=new Address1ntabsx();<br/>
Address1ntabsx add2=new Address1ntabsx();<br/>
Person1ntabsx p=new Person1ntabsx();<br/>

<p><br/>
add1.setAddressdetail("郑州市经三路");<br/>
add2.setAddressdetail("合肥市宿州路");<br/>
p.setName("wang");<br/>
p.setAge(30);<br/>
</p>
<p><br/>
p.getAddresses().add(add1);<br/>
p.getAddresses().add(add2);<br/>
add1.setPerson1ntabsx(p);<br/>
add2.setPerson1ntabsx(p);<br/>
</p>
<p><br/>
Session session= HibernateUtil.getCurrentSession();<br/>
Transaction tx=session.beginTransaction();<br/>
//        session.save(p);<br/>
session.saveOrUpdate(add1);<br/>
session.saveOrUpdate(add2);<br/>
tx.commit();<br/>
HibernateUtil.closeSession();<br/>
}<br/>
}<br/>
</p></li>
</ul>
</div>
</div>

</div>

<div id="outline-container-2_3" class="outline-3">
<h3 id="sec-2_3"><span class="section-number-3">2.3</span> 多对多 </h3>
<div class="outline-text-3" id="text-2_3">


</div>

<div id="outline-container-2_3_1" class="outline-4">
<h4 id="sec-2_3_1"><span class="section-number-4">2.3.1</span> 模型 </h4>
<div class="outline-text-4" id="text-2_3_1">

<p>一个人对应多个地址,一个地址也对应多个人<br/>
</p></div>

</div>

<div id="outline-container-2_3_2" class="outline-4">
<h4 id="sec-2_3_2"><span class="section-number-4">2.3.2</span> 实体 </h4>
<div class="outline-text-4" id="text-2_3_2">

<p>public class Personnnsx {<br/>
private int personid;<br/>
private String name;<br/>
private int age;<br/>
private Set addresses=new HashSet();<br/>
} <br/>
public class Addressnnsx {<br/>
private int addressid;<br/>
private String addressdetail;<br/>
private Set persons = new HashSet();<br/>
}<br/>
</p><ul>
<li>
说明<br/>
2个类的Set集合都互为对方的属性<br/>
</li>
</ul>
</div>

</div>

<div id="outline-container-2_3_3" class="outline-4">
<h4 id="sec-2_3_3"><span class="section-number-4">2.3.3</span> 表模型 </h4>
<div class="outline-text-4" id="text-2_3_3">

<p>mysql&gt; desc person<sub>nnsx</sub>;<br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>personid<br/>name<br/>age</td>
<td>int(11)<br/>varchar(255)<br/>int(11)</td>
<td>NO<br/>YES<br/>YES</td>
<td>PRI<br/><br/></td>
<td>NULL<br/>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc address<sub>nnsx</sub>;<br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>addressid<br/>addressdetail</td>
<td>int(11)<br/>varchar(255)</td>
<td>NO<br/>YES</td>
<td>PRI<br/></td>
<td>NULL<br/>NULL</td>
<td>auto<sub>increment</sub><br/></td></tr>
</table>

<p><br/>
mysql&gt; desc join<sub>nnsx</sub>;<br/>
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<tr><th scope="col">Field</th>
<th scope="col">Type</th>
<th scope="col">Null</th>
<th scope="col">Key</th>
<th scope="col">Default</th>
<th scope="col">Extra</th></tr>
<tr><td>addressid<br/>personid</td>
<td>int(11)<br/>int(11)</td>
<td>NO<br/>NO</td>
<td>PRI<br/>PRI</td>
<td><br/></td>
<td><br/></td></tr>
</table>
<ul>
<li>
说明<br/>
2个类的主键都在新的jion表中为主键    <br/>

<p><br/>
</p></li>
</ul>
</div>

</div>

<div id="outline-container-2_3_4" class="outline-4">
<h4 id="sec-2_3_4"><span class="section-number-4">2.3.4</span> SQL脚本 </h4>
<div class="outline-text-4" id="text-2_3_4">

<p>CREATE TABLE `address<sub>nnsx`</sub> (<br/>
`addressid` int(11) NOT NULL auto<sub>increment</sub>,<br/>
`addressdetail` varchar(255) default NULL,<br/>
PRIMARY KEY  (`addressid`)<br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk;<br/>
CREATE TABLE `person<sub>nnsx`</sub> (<br/>
`personid` int(11) NOT NULL auto<sub>increment</sub>,<br/>
`name` varchar(255) default NULL,<br/>
`age` int(11) default NULL,<br/>
PRIMARY KEY  (`personid`)<br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk;<br/>
CREATE TABLE `join<sub>nnsx`</sub> (<br/>
`addressid` int(11) NOT NULL,<br/>
`personid` int(11) NOT NULL,<br/>
PRIMARY KEY  (`personid`,`addressid`),<br/>
KEY `FK6EBBC5EF6C600921` (`personid`),<br/>
KEY `FK6EBBC5EF2A92FF3D` (`addressid`),<br/>
CONSTRAINT `FK6EBBC5EF2A92FF3D` FOREIGN KEY (`addressid`) REFERENCES `address<sub>nnsx`</sub> (`addressid`),<br/>
CONSTRAINT `FK6EBBC5EF6C600921` FOREIGN KEY (`personid`) REFERENCES `person<sub>nnsx`</sub> (`personid`)<br/>
) ENGINE=InnoDB DEFAULT CHARSET=gbk;<br/>
</p></div>

</div>

<div id="outline-container-2_3_5" class="outline-4">
<h4 id="sec-2_3_5"><span class="section-number-4">2.3.5</span> 映射方法 </h4>
<div class="outline-text-4" id="text-2_3_5">

<p>&lt;hibernate-mapping&gt;<br/>
&lt;class name="com.lavasoft.sx.<sub>n</sub><sub>n</sub>.Personnnsx" table="PERSON<sub>nnsx</sub>"&gt;<br/>
&lt;id name="personid"&gt;<br/>
&lt;generator class="identity"/&gt;<br/>
&lt;/id&gt;<br/>
&lt;property name="name"/&gt;<br/>
&lt;property name="age"/&gt;<br/>
&lt;!&ndash;映射集合属性，关联到持久化类&ndash;&gt;<br/>
&lt;!&ndash;table="join<sub>1ntabsx</sub>"指定了连接表的名字&ndash;&gt;<br/>
&lt;set name="addresses"<br/>
table="join<sub>nnsx</sub>"<br/>
cascade="all"&gt;<br/>
&lt;!&ndash;column="personid"指定连接表中关联当前实体类的列名&ndash;&gt;<br/>
&lt;key column="personid" not-null="true"/&gt;<br/>
&lt;!&ndash;column="addressid"是连接表中关联本实体的外键&ndash;&gt;<br/>
&lt;many-to-many column="addressid"<br/>
class="com.lavasoft.sx.<sub>n</sub><sub>n</sub>.Addressnnsx"/&gt;<br/>
&lt;/set&gt;<br/>
&lt;/class&gt;<br/>
&lt;/hibernate-mapping&gt;<br/>
&lt;hibernate-mapping&gt;<br/>
&lt;class name="com.lavasoft.sx.<sub>n</sub><sub>n</sub>.Addressnnsx"<br/>
table="ADDRESS<sub>nnsx</sub>"&gt;<br/>
&lt;id name="addressid"&gt;<br/>
&lt;generator class="identity"/&gt;<br/>
&lt;/id&gt;<br/>
&lt;property name="addressdetail"/&gt;<br/>
&lt;!&ndash;table="join<sub>nnsx</sub>"是双向多对多的连接表&ndash;&gt;<br/>
&lt;set name="persons"<br/>
inverse="true"<br/>
table="join<sub>nnsx</sub>"&gt;<br/>
&lt;!&ndash;column="addressid"是连接表中关联本实体的外键&ndash;&gt;<br/>
&lt;key column="addressid"/&gt;<br/>
&lt;many-to-many column="personid"<br/>
class="com.lavasoft.sx.<sub>n</sub><sub>n</sub>.Personnnsx"/&gt;<br/>
&lt;/set&gt;<br/>
&lt;/class&gt;<br/>
&lt;/hibernate-mapping&gt;<br/>
</p><ul>
<li>
说明<br/>
set集合对应在配置中使用set<br/>

<p><br/>
<pre class="src src-c"> &lt;set name=<span style="color: #ffa07a;">"&#20851;&#32852;&#21040;&#30340;&#21478;&#19968;&#20010;&#34920;&#21517;&#31216;"</span> table=<span style="color: #ffa07a;">"&#36830;&#25509;&#34920;&#21517;&#31216;"</span>&gt;
   &lt;key column=<span style="color: #ffa07a;">"&#36830;&#25509;&#34920;&#20013;&#20851;&#32852;&#24403;&#21069;&#23454;&#20307;&#30340;&#21015;&#21517;"</span> not-null=<span style="color: #ffa07a;">"true"</span>/&gt;
   &lt;many-to-many column=<span style="color: #ffa07a;">"&#36830;&#25509;&#34920;&#20013;&#20851;&#32852;&#21040;&#30340;&#21478;&#19968;&#20010;&#23454;&#20307;&#30340;&#22806;&#38190;"</span> class=<span style="color: #ffa07a;">"&#20851;&#32852;&#21040;&#30340;&#21478;&#19968;&#20010;&#34920;&#30340;&#23454;&#20307;&#31867;&#21517;&#31216;"</span>/&gt;
&lt;/set&gt;
</pre>


</p></li>
</ul>
</div>

</div>

<div id="outline-container-2_3_6" class="outline-4">
<h4 id="sec-2_3_6"><span class="section-number-4">2.3.6</span> 测试方法 </h4>
<div class="outline-text-4" id="text-2_3_6">

<p>public class Test<sub>nnsx</sub> {<br/>
public static void main(String[] args){<br/>
Addressnnsx add1=new Addressnnsx();<br/>
Addressnnsx add2=new Addressnnsx();<br/>
Personnnsx p1=new Personnnsx();<br/>
Personnnsx p2=new Personnnsx();<br/>
</p>
<p><br/>
add1.setAddressdetail("郑州市经三路");<br/>
add2.setAddressdetail("合肥市宿州路");<br/>
p1.setName("wang");<br/>
p1.setAge(30);<br/>
p2.setName("zhang");<br/>
p2.setAge(22);<br/>
</p>
<p><br/>
p1.getAddresses().add(add1);<br/>
p1.getAddresses().add(add2);<br/>
p2.getAddresses().add(add2);<br/>
add1.getPersons().add(p1);<br/>
add2.getPersons().add(p1);<br/>
add2.getPersons().add(p2);<br/>
</p>
<p><br/>
</p>
<p><br/>
Session session= HibernateUtil.getCurrentSession();<br/>
Transaction tx=session.beginTransaction();<br/>
session.save(p1);<br/>
session.save(p2);<br/>
//        session.saveOrUpdate(add1);<br/>
//        session.saveOrUpdate(add2);<br/>
tx.commit();<br/>
HibernateUtil.closeSession();<br/>
}<br/>
}<br/>
</p></div>
</div>
</div>
</div>
<div id="postamble">
<p class="author"> Author: 
</p>
<p class="date"> Date: 2011-02-10 16:52:05 </p>
<p class="creator">HTML generated by org-mode 7.01 in emacs 24</p>
</div>
</div>
</body>
</html>
